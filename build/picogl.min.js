/*
PicoGL.js v0.2.4 

The MIT License (MIT)

Copyright (c) 2017 Tarek Sherif

Permission is hereby granted, free of charge, to any person obtaining a copy of
this software and associated documentation files (the "Software"), to deal in
the Software without restriction, including without limitation the rights to
use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of
the Software, and to permit persons to whom the Software is furnished to do so,
subject to the following conditions:

The above copyright notice and this permission notice shall be included in all
copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS
FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR
COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER
IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN
CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
*/
!function(){"use strict";var a=window.PicoGL={version:"0.2.4"};!function(){var b=document.createElement("canvas"),c=b.getContext("webgl2");if(c){for(var d in c)d.match(/^[A-Z0-9_x]+$/)&&"number"==typeof c[d]&&(a[d]=c[d]);a.TEXTURE_INTERNAL_FORMAT={};var e=a.TEXTURE_INTERNAL_FORMAT[c.UNSIGNED_BYTE]={};e[c.RED]=c.R8,e[c.RG]=c.RG8,e[c.RGB]=c.RGB,e[c.RGBA]=c.RGBA;(a.TEXTURE_INTERNAL_FORMAT[c.UNSIGNED_SHORT]={})[c.DEPTH_COMPONENT]=c.DEPTH_COMPONENT16;var f=a.TEXTURE_INTERNAL_FORMAT[c.FLOAT]={};f[c.RED]=c.R16F,f[c.RG]=c.RG16F,f[c.RGB]=c.RGB16F,f[c.RGBA]=c.RGBA16F,f[c.DEPTH_COMPONENT]=c.DEPTH_COMPONENT32F,a.TYPE_SIZE={},a.TYPE_SIZE[c.BYTE]=1,a.TYPE_SIZE[c.UNSIGNED_BYTE]=1,a.TYPE_SIZE[c.SHORT]=2,a.TYPE_SIZE[c.UNSIGNED_SHORT]=2,a.TYPE_SIZE[c.INT]=4,a.TYPE_SIZE[c.UNSIGNED_INT]=4,a.TYPE_SIZE[c.FLOAT]=4,a.WEBGL_INFO={},a.WEBGL_INFO.MAX_TEXTURE_UNITS=c.getParameter(c.MAX_COMBINED_TEXTURE_IMAGE_UNITS),a.WEBGL_INFO.MAX_UNIFORM_BUFFERS=c.getParameter(c.MAX_UNIFORM_BUFFER_BINDINGS),a.TEXTURE_UNIT_MAP=new Array(a.WEBGL_INFO.MAX_TEXTURE_UNITS);for(var g=0,h=a.TEXTURE_UNIT_MAP.length;g<h;++g)a.TEXTURE_UNIT_MAP[g]=c["TEXTURE"+g]}}(),a.DUMMY_OBJECT={},a.createApp=function(b,c){return new a.App(b,c)}}(),function(){"use strict";PicoGL.App=function(a,b){this.canvas=a,this.gl=a.getContext("webgl2",b),this.width=this.gl.drawingBufferWidth,this.height=this.gl.drawingBufferHeight,this.currentDrawCalls=null,this.emptyFragmentShader=null,this.currentState={program:null,vertexArray:null},this.clearBits=this.gl.COLOR_BUFFER_BIT|this.gl.DEPTH_BUFFER_BIT,this.timer=new PicoGL.Timer(this.gl),this.cpuTime=0,this.gpuTime=0,this.floatRenderTargetsEnabled=!1,this.linearFloatTexturesEnabled=!1,this.gl.viewport(0,0,this.width,this.height)},PicoGL.App.prototype.clearMask=function(a){return this.clearBits=a,this},PicoGL.App.prototype.clearColor=function(a,b,c,d){return this.gl.clearColor(a,b,c,d),this},PicoGL.App.prototype.clear=function(){return this.gl.clear(this.clearBits),this},PicoGL.App.prototype.drawCalls=function(a){return this.currentDrawCalls=a,this},PicoGL.App.prototype.framebuffer=function(a){return this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,a.framebuffer),this.gl.viewport(0,0,a.width,a.height),this},PicoGL.App.prototype.defaultFramebuffer=function(){return this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,null),this.gl.viewport(0,0,this.width,this.height),this},PicoGL.App.prototype.depthRange=function(a,b){return this.gl.depthRange(a,b),this},PicoGL.App.prototype.depthTest=function(){return this.gl.enable(this.gl.DEPTH_TEST),this},PicoGL.App.prototype.noDepthTest=function(){return this.gl.disable(this.gl.DEPTH_TEST),this},PicoGL.App.prototype.depthMask=function(){return this.gl.depthMask(!0),this},PicoGL.App.prototype.noDepthMask=function(){return this.gl.depthMask(!1),this},PicoGL.App.prototype.blend=function(){return this.gl.enable(this.gl.BLEND),this},PicoGL.App.prototype.noBlend=function(){return this.gl.disable(this.gl.BLEND),this},PicoGL.App.prototype.rasterize=function(){return this.gl.disable(this.gl.RASTERIZER_DISCARD),this},PicoGL.App.prototype.noRasterize=function(){return this.gl.enable(this.gl.RASTERIZER_DISCARD),this},PicoGL.App.prototype.depthFunc=function(a){return this.gl.depthFunc(a),this},PicoGL.App.prototype.blendFunc=function(a,b){return this.gl.blendFunc(a,b),this},PicoGL.App.prototype.blendFuncSeparate=function(a,b,c,d){return this.gl.blendFuncSeparate(a,b,c,d),this},PicoGL.App.prototype.cullBackfaces=function(){return this.gl.enable(this.gl.CULL_FACE),this},PicoGL.App.prototype.drawBackfaces=function(){return this.gl.disable(this.gl.CULL_FACE),this},PicoGL.App.prototype.floatRenderTargets=function(){return this.floatRenderTargetsEnabled=!!this.gl.getExtension("EXT_color_buffer_float"),this.floatRenderTargetsEnabled||console.warn("Extension EXT_color_buffer_float unavailable. Cannot enable float textures."),this},PicoGL.App.prototype.linearFloatTextures=function(){return this.linearFloatTexturesEnabled=!!this.gl.getExtension("OES_texture_float_linear"),this.linearFloatTexturesEnabled||console.warn("Extension OES_texture_float_linear unavailable. Cannot enable float texture linear filtering."),this},PicoGL.App.prototype.readPixel=function(a,b,c){return this.gl.readPixels(a,b,1,1,this.gl.RGBA,this.gl.UNSIGNED_BYTE,c),this},PicoGL.App.prototype.resize=function(a,b){return this.canvas.width=a,this.canvas.height=b,this.width=this.gl.drawingBufferWidth,this.height=this.gl.drawingBufferHeight,this.gl.viewport(0,0,this.width,this.height),this},PicoGL.App.prototype.createProgram=function(a,b,c){return new PicoGL.Program(this.gl,a,b,c)},PicoGL.App.prototype.createShader=function(a,b){return new PicoGL.Shader(this.gl,a,b)},PicoGL.App.prototype.createVertexArray=function(){return new PicoGL.VertexArray(this.gl)},PicoGL.App.prototype.createTransformFeedback=function(a,b,c){return new PicoGL.TransformFeedback(this.gl,a,b,c)},PicoGL.App.prototype.createVertexBuffer=function(a,b,c,d){return new PicoGL.VertexBuffer(this.gl,a,b,c,d)},PicoGL.App.prototype.createInstanceBuffer=function(a,b,c,d){return new PicoGL.VertexBuffer(this.gl,a,b,c,d,!1,!0)},PicoGL.App.prototype.createVertexMatrixBuffer=function(a,b,c){return new PicoGL.VertexBuffer(this.gl,a,null,b,c)},PicoGL.App.prototype.createInstanceMatrixBuffer=function(a,b,c){return new PicoGL.VertexBuffer(this.gl,a,null,b,c,!1,!0)},PicoGL.App.prototype.createIndexBuffer=function(a,b,c){return new PicoGL.VertexBuffer(this.gl,a,b,c,null,!0)},PicoGL.App.prototype.createUniformBuffer=function(a,b){return new PicoGL.UniformBuffer(this.gl,a,b)},PicoGL.App.prototype.createTexture2D=function(a,b,c,d){return void 0===c&&(d=b),new PicoGL.Texture(this.gl,this.gl.TEXTURE_2D,a,b,c,null,!1,d)},PicoGL.App.prototype.createTextureArray=function(a,b,c,d,e){return new PicoGL.Texture(this.gl,this.gl.TEXTURE_2D_ARRAY,a,b,c,d,!0,e)},PicoGL.App.prototype.createTexture3D=function(a,b,c,d,e){return new PicoGL.Texture(this.gl,this.gl.TEXTURE_3D,a,b,c,d,!0,e)},PicoGL.App.prototype.createCubemap=function(a){return new PicoGL.Cubemap(this.gl,a)},PicoGL.App.prototype.createFramebuffer=function(a,b){return new PicoGL.Framebuffer(this.gl,a,b)},PicoGL.App.prototype.createDrawCall=function(a,b,c){return new PicoGL.DrawCall(this.gl,a,b,c)},PicoGL.App.prototype.draw=function(){for(var a=0,b=this.currentDrawCalls.length;a<b;a++)this.currentDrawCalls[a].draw(this.currentState);return this},PicoGL.App.prototype.timerStart=function(){return this.timer.start(),this},PicoGL.App.prototype.timerEnd=function(){return this.timer.end(),this},PicoGL.App.prototype.timerReady=function(){return!!this.timer.ready()&&(this.cpuTime=this.timer.cpuTime,this.gpuTime=this.timer.gpuTime,!0)}}(),function(){"use strict";PicoGL.Program=function(a,b,c,d){var e,f,g,h=!1,i=!1;"string"==typeof b?(f=new PicoGL.Shader(a,a.VERTEX_SHADER,b),h=!0):f=b,"string"==typeof c?(g=new PicoGL.Shader(a,a.FRAGMENT_SHADER,c),i=!0):g=c;var j=a.createProgram();a.attachShader(j,f.shader),a.attachShader(j,g.shader),d&&a.transformFeedbackVaryings(j,d,a.SEPARATE_ATTRIBS),a.linkProgram(j),a.getProgramParameter(j,a.LINK_STATUS)||console.error(a.getProgramInfoLog(j)),h&&f.delete(),i&&g.delete(),this.gl=a,this.program=j,this.transformFeedback=!!d,this.uniforms={},this.uniformBlocks={};var k=a.getProgramParameter(j,a.ACTIVE_UNIFORMS);for(e=0;e<k;++e){var l=a.getActiveUniform(j,e),m=a.getUniformLocation(this.program,l.name),n=null;switch(l.type){case PicoGL.INT:case PicoGL.BOOL:case PicoGL.SAMPLER_2D:case PicoGL.INT_SAMPLER_2D:case PicoGL.UNSIGNED_INT_SAMPLER_2D:case PicoGL.SAMPLER_2D_SHADOW:case PicoGL.SAMPLER_2D_ARRAY:case PicoGL.INT_SAMPLER_2D_ARRAY:case PicoGL.UNSIGNED_INT_SAMPLER_2D_ARRAY:case PicoGL.SAMPLER_2D_ARRAY_SHADOW:case PicoGL.SAMPLER_CUBE:case PicoGL.INT_SAMPLER_CUBE:case PicoGL.UNSIGNED_INT_SAMPLER_CUBE:case PicoGL.SAMPLER_CUBE_SHADOW:case PicoGL.SAMPLER_3D:case PicoGL.INT_SAMPLER_3D:case PicoGL.UNSIGNED_INT_SAMPLER_3D:n=PicoGL.IntUniform;break;case PicoGL.UNSIGNED_INT:n=PicoGL.UintUniform;break;case PicoGL.FLOAT:n=PicoGL.FloatUniform;break;case PicoGL.FLOAT_VEC2:n=PicoGL.Vec2Uniform;break;case PicoGL.FLOAT_VEC3:n=PicoGL.Vec3Uniform;break;case PicoGL.FLOAT_VEC4:n=PicoGL.Vec4Uniform;break;case PicoGL.INT_VEC2:n=PicoGL.IntVec2Uniform;break;case PicoGL.INT_VEC3:n=PicoGL.IntVec3Uniform;break;case PicoGL.INT_VEC4:n=PicoGL.IntVec4Uniform;break;case PicoGL.UNSIGNED_INT_VEC2:n=PicoGL.UintVec2Uniform;break;case PicoGL.UNSIGNED_INT_VEC3:n=PicoGL.UintVec3Uniform;break;case PicoGL.UNSIGNED_INT_VEC4:n=PicoGL.UintVec4Uniform;break;case PicoGL.BOOL_VEC2:n=PicoGL.BoolVec2Uniform;break;case PicoGL.BOOL_VEC3:n=PicoGL.BoolVec3Uniform;break;case PicoGL.BOOL_VEC4:n=PicoGL.BoolVec4Uniform;break;case PicoGL.FLOAT_MAT2:n=PicoGL.Mat2Uniform;break;case PicoGL.FLOAT_MAT3:n=PicoGL.Mat3Uniform;break;case PicoGL.FLOAT_MAT4:n=PicoGL.Mat4Uniform;break;case PicoGL.FLOAT_MAT2x3:n=PicoGL.Mat2x3Uniform;break;case PicoGL.FLOAT_MAT2x4:n=PicoGL.Mat2x4Uniform;break;case PicoGL.FLOAT_MAT3x2:n=PicoGL.Mat3x2Uniform;break;case PicoGL.FLOAT_MAT3x4:n=PicoGL.Mat3x4Uniform;break;case PicoGL.FLOAT_MAT4x2:n=PicoGL.Mat4x2Uniform;break;case PicoGL.FLOAT_MAT4x3:n=PicoGL.Mat4x3Uniform;break;default:console.error("Unrecognized type for uniform ",l.name)}this.uniforms[l.name]=new n(a,m)}var o=a.getProgramParameter(j,a.ACTIVE_UNIFORM_BLOCKS);for(e=0;e<o;++e){var p=a.getActiveUniformBlockName(this.program,e),q=a.getUniformBlockIndex(this.program,p);this.uniformBlocks[p]=q}},PicoGL.Program.prototype.delete=function(){this.program&&(this.gl.deleteProgram(this.program),this.program=null)},PicoGL.Program.prototype.uniform=function(a,b){this.uniforms[a].set(b)},PicoGL.Program.prototype.uniformBlock=function(a,b){this.gl.uniformBlockBinding(this.program,this.uniformBlocks[a],b)}}(),function(){"use strict";PicoGL.Shader=function(a,b,c){if(this.gl=a,this.shader=a.createShader(b),a.shaderSource(this.shader,c),a.compileShader(this.shader),!a.getShaderParameter(this.shader,a.COMPILE_STATUS)){var d,e;for(console.error(a.getShaderInfoLog(this.shader)),e=c.split("\n"),d=0;d<e.length;++d)console.error(d+1+":",e[d])}},PicoGL.Shader.prototype.delete=function(){this.shader&&(this.gl.deleteShader(this.shader),this.shader=null)}}(),function(){"use strict";PicoGL.VertexArray=function(a){this.gl=a,this.vertexArray=a.createVertexArray(),this.attributeBuffers=[],this.numElements=0,this.indexType=null,this.instanced=!1,this.indexed=!1,this.numInstances=0},PicoGL.VertexArray.prototype.attributeBuffer=function(a,b){this.gl.bindVertexArray(this.vertexArray),this.attributeBuffers[a]=b;var c=b.numRows;b.bind();for(var d=0;d<c;++d)this.gl.vertexAttribPointer(a+d,b.itemSize,b.type,!1,c*b.itemSize*PicoGL.TYPE_SIZE[b.type],d*b.itemSize*PicoGL.TYPE_SIZE[b.type]),b.instanced&&this.gl.vertexAttribDivisor(a+d,1),this.gl.enableVertexAttribArray(a+d);return this.instanced=this.instanced||b.instanced,b.instanced?this.numInstances=b.numItems:this.numElements=this.numElements||b.numItems,this.gl.bindVertexArray(null),this},PicoGL.VertexArray.prototype.indexBuffer=function(a){return this.gl.bindVertexArray(this.vertexArray),a.bind(),this.numElements=3*a.numItems,this.indexType=a.type,this.indexed=!0,this.gl.bindVertexArray(null),this},PicoGL.VertexArray.prototype.delete=function(){this.vertexArray&&(this.gl.deleteVertexArray(this.vertexArray),this.vertexArray=null)},PicoGL.VertexArray.prototype.bind=function(){return this.gl.bindVertexArray(this.vertexArray),this},PicoGL.VertexArray.prototype.unbind=function(){return this.gl.bindVertexArray(null),this}}(),function(){"use strict";PicoGL.TransformFeedback=function(a,b,c,d){this.gl=a,this.transformFeedback=a.createTransformFeedback(),this.inputVertexArray=b,this.outputVertexArray=c,this.inputBuffers=new Array(d.length),this.outputBuffers=new Array(d.length);for(var e=0,f=d.length;e<f;++e)this.inputBuffers[e]=b.attributeBuffers[d[e]],this.outputBuffers[e]=c.attributeBuffers[d[e]]},PicoGL.TransformFeedback.prototype.swapBuffers=function(){var a=this.inputVertexArray;this.inputVertexArray=this.outputVertexArray,this.outputVertexArray=a;var b=this.inputBuffers;return this.inputBuffers=this.outputBuffers,this.outputBuffers=b,this},PicoGL.TransformFeedback.prototype.delete=function(){this.transformFeedback&&(this.gl.deleteTransformFeedback(this.transformFeedback),this.transformFeedback=null)},PicoGL.TransformFeedback.prototype.bind=function(a){this.gl.bindTransformFeedback(this.gl.TRANSFORM_FEEDBACK,this.transformFeedback);for(var b=0,c=this.outputBuffers.length;b<c;++b)this.gl.bindBufferBase(this.gl.TRANSFORM_FEEDBACK_BUFFER,b,this.outputBuffers[b].buffer);return this.gl.beginTransformFeedback(a),this},PicoGL.TransformFeedback.prototype.unbind=function(){return this.gl.endTransformFeedback(),this.gl.bindTransformFeedback(this.gl.TRANSFORM_FEEDBACK,null),this}}(),function(){"use strict";PicoGL.VertexBuffer=function(a,b,c,d,e,f,g){var h=1;b===PicoGL.FLOAT_MAT4?(b=PicoGL.FLOAT,c=4,h=4):b===PicoGL.FLOAT_MAT3?(b=PicoGL.FLOAT,c=3,h=3):b===PicoGL.FLOAT_MAT2&&(b=PicoGL.FLOAT,c=2,h=2);var i;"number"==typeof d?(i=d,d*=PicoGL.TYPE_SIZE[b]):i=d.length,this.gl=a,this.buffer=a.createBuffer(),this.type=b,this.itemSize=c,this.numItems=i/(c*h),this.numRows=h,this.usage=e||a.STATIC_DRAW,this.indexArray=!!f,this.instanced=!!g,this.binding=this.indexArray?a.ELEMENT_ARRAY_BUFFER:a.ARRAY_BUFFER,a.bindBuffer(this.binding,this.buffer),a.bufferData(this.binding,d,this.usage),a.bindBuffer(this.binding,null)},PicoGL.VertexBuffer.prototype.data=function(a){return this.gl.bindBuffer(this.binding,this.buffer),this.gl.bufferSubData(this.binding,0,a),this.gl.bindBuffer(this.binding,null),this},PicoGL.VertexBuffer.prototype.delete=function(){this.buffer&&(this.gl.deleteBuffer(this.buffer),this.buffer=null)},PicoGL.VertexBuffer.prototype.bind=function(){return this.gl.bindBuffer(this.binding,this.buffer),this}}(),function(){"use strict";PicoGL.FloatUniform=function(a,b){this.gl=a,this.handle=b,this.cache=0},PicoGL.FloatUniform.prototype.set=function(a){this.cache!==a&&(this.gl.uniform1f(this.handle,a),this.cache=a)},PicoGL.IntUniform=function(a,b){this.gl=a,this.handle=b,this.cache=0},PicoGL.IntUniform.prototype.set=function(a){this.cache!==a&&(this.gl.uniform1i(this.handle,a),this.cache=a)},PicoGL.UintUniform=function(a,b){this.gl=a,this.handle=b,this.cache=0},PicoGL.UintUniform.prototype.set=function(a){this.cache!==a&&(this.gl.uniform1ui(this.handle,a),this.cache=a)},PicoGL.Vec2Uniform=function(a,b){this.gl=a,this.handle=b,this.cache=new Float32Array(2)},PicoGL.Vec2Uniform.prototype.set=function(a){this.cache[0]===a[0]&&this.cache[1]===a[1]||(this.gl.uniform2fv(this.handle,a),this.cache.set(a))},PicoGL.Vec3Uniform=function(a,b){this.gl=a,this.handle=b,this.cache=new Float32Array(3)},PicoGL.Vec3Uniform.prototype.set=function(a){this.cache[0]===a[0]&&this.cache[1]===a[1]&&this.cache[2]===a[2]||(this.gl.uniform3fv(this.handle,a),this.cache.set(a))},PicoGL.Vec4Uniform=function(a,b){this.gl=a,this.handle=b,this.cache=new Float32Array(4)},PicoGL.Vec4Uniform.prototype.set=function(a){this.cache[0]===a[0]&&this.cache[1]===a[1]&&this.cache[2]===a[2]&&this.cache[3]===a[3]||(this.gl.uniform4fv(this.handle,a),this.cache.set(a))},PicoGL.IntVec2Uniform=function(a,b){this.gl=a,this.handle=b,this.cache=new Int32Array(2)},PicoGL.IntVec2Uniform.prototype.set=function(a){this.cache[0]===a[0]&&this.cache[1]===a[1]||(this.gl.uniform2iv(this.handle,a),this.cache.set(a))},PicoGL.IntVec3Uniform=function(a,b){this.gl=a,this.handle=b,this.cache=new Int32Array(3)},PicoGL.IntVec3Uniform.prototype.set=function(a){this.cache[0]===a[0]&&this.cache[1]===a[1]&&this.cache[2]===a[2]||(this.gl.uniform3iv(this.handle,a),this.cache.set(a))},PicoGL.IntVec4Uniform=function(a,b){this.gl=a,this.handle=b,this.cache=new Int32Array(4)},PicoGL.IntVec4Uniform.prototype.set=function(a){this.cache[0]===a[0]&&this.cache[1]===a[1]&&this.cache[2]===a[2]&&this.cache[3]===a[3]||(this.gl.uniform4iv(this.handle,a),this.cache.set(a))},PicoGL.UintVec2Uniform=function(a,b){this.gl=a,this.handle=b,this.cache=new Uint32Array(2)},PicoGL.UintVec2Uniform.prototype.set=function(a){this.cache[0]===a[0]&&this.cache[1]===a[1]||(this.gl.uniform2uiv(this.handle,a),this.cache.set(a))},PicoGL.UintVec3Uniform=function(a,b){this.gl=a,this.handle=b,this.cache=new Uint32Array(3)},PicoGL.UintVec3Uniform.prototype.set=function(a){this.cache[0]===a[0]&&this.cache[1]===a[1]&&this.cache[2]===a[2]||(this.gl.uniform3uiv(this.handle,a),this.cache.set(a))},PicoGL.UintVec4Uniform=function(a,b){this.gl=a,this.handle=b,this.cache=new Uint32Array(4)},PicoGL.UintVec4Uniform.prototype.set=function(a){this.cache[0]===a[0]&&this.cache[1]===a[1]&&this.cache[2]===a[2]&&this.cache[3]===a[3]||(this.gl.uniform4uiv(this.handle,a),this.cache.set(a))},PicoGL.BoolVec2Uniform=function(a,b){this.gl=a,this.handle=b,this.cache=[!1,!1]},PicoGL.BoolVec2Uniform.prototype.set=function(a){this.cache[0]===a[0]&&this.cache[1]===a[1]||(this.gl.uniform2iv(this.handle,a),this.cache[0]=a[0],this.cache[1]=a[1])},PicoGL.BoolVec3Uniform=function(a,b){this.gl=a,this.handle=b,this.cache=[!1,!1,!1]},PicoGL.BoolVec3Uniform.prototype.set=function(a){this.cache[0]===a[0]&&this.cache[1]===a[1]&&this.cache[2]===a[2]||(this.gl.uniform3iv(this.handle,a),this.cache[0]=a[0],this.cache[1]=a[1],this.cache[2]=a[2])},PicoGL.BoolVec4Uniform=function(a,b){this.gl=a,this.handle=b,this.cache=[!1,!1,!1,!1]},PicoGL.BoolVec4Uniform.prototype.set=function(a){this.cache[0]===a[0]&&this.cache[1]===a[1]&&this.cache[2]===a[2]&&this.cache[3]===a[3]||(this.gl.uniform4iv(this.handle,a),this.cache[0]=a[0],this.cache[1]=a[1],this.cache[2]=a[2],this.cache[3]=a[3])},PicoGL.Mat2Uniform=function(a,b){this.gl=a,this.handle=b,this.cache=new Float32Array(4)},PicoGL.Mat2Uniform.prototype.set=function(a){this.cache[0]===a[0]&&this.cache[1]===a[1]&&this.cache[2]===a[2]&&this.cache[3]===a[3]||(this.gl.uniformMatrix2fv(this.handle,!1,a),this.cache.set(a))},PicoGL.Mat3Uniform=function(a,b){this.gl=a,this.handle=b,this.cache=new Float32Array(9)},PicoGL.Mat3Uniform.prototype.set=function(a){this.cache[0]===a[0]&&this.cache[1]===a[1]&&this.cache[2]===a[2]&&this.cache[3]===a[3]&&this.cache[4]===a[4]&&this.cache[5]===a[5]&&this.cache[6]===a[6]&&this.cache[7]===a[7]&&this.cache[8]===a[8]||(this.gl.uniformMatrix3fv(this.handle,!1,a),this.cache.set(a))},PicoGL.Mat4Uniform=function(a,b){this.gl=a,this.handle=b,this.cache=new Float32Array(16)},PicoGL.Mat4Uniform.prototype.set=function(a){this.cache[0]===a[0]&&this.cache[1]===a[1]&&this.cache[2]===a[2]&&this.cache[3]===a[3]&&this.cache[4]===a[4]&&this.cache[5]===a[5]&&this.cache[6]===a[6]&&this.cache[7]===a[7]&&this.cache[8]===a[8]&&this.cache[9]===a[9]&&this.cache[10]===a[10]&&this.cache[11]===a[11]&&this.cache[12]===a[12]&&this.cache[13]===a[13]&&this.cache[14]===a[14]&&this.cache[15]===a[15]||(this.gl.uniformMatrix4fv(this.handle,!1,a),this.cache.set(a))},PicoGL.Mat2x3Uniform=function(a,b){this.gl=a,this.handle=b,this.cache=new Float32Array(6)},PicoGL.Mat2x3Uniform.prototype.set=function(a){this.cache[0]===a[0]&&this.cache[1]===a[1]&&this.cache[2]===a[2]&&this.cache[3]===a[3]&&this.cache[4]===a[4]&&this.cache[5]===a[5]||(this.gl.uniformMatrix2x3fv(this.handle,!1,a),this.cache.set(a))},PicoGL.Mat2x4Uniform=function(a,b){this.gl=a,this.handle=b,this.cache=new Float32Array(8)},PicoGL.Mat2x4Uniform.prototype.set=function(a){this.cache[0]===a[0]&&this.cache[1]===a[1]&&this.cache[2]===a[2]&&this.cache[3]===a[3]&&this.cache[4]===a[4]&&this.cache[5]===a[5]&&this.cache[6]===a[6]&&this.cache[7]===a[7]||(this.gl.uniformMatrix2x4fv(this.handle,!1,a),this.cache.set(a))},PicoGL.Mat3x2Uniform=function(a,b){this.gl=a,this.handle=b,this.cache=new Float32Array(6)},PicoGL.Mat3x2Uniform.prototype.set=function(a){this.cache[0]===a[0]&&this.cache[1]===a[1]&&this.cache[2]===a[2]&&this.cache[3]===a[3]&&this.cache[4]===a[4]&&this.cache[5]===a[5]||(this.gl.uniformMatrix3x2fv(this.handle,!1,a),this.cache.set(a))},PicoGL.Mat3x4Uniform=function(a,b){this.gl=a,this.handle=b,this.cache=new Float32Array(12)},PicoGL.Mat3x4Uniform.prototype.set=function(a){this.cache[0]===a[0]&&this.cache[1]===a[1]&&this.cache[2]===a[2]&&this.cache[3]===a[3]&&this.cache[4]===a[4]&&this.cache[5]===a[5]&&this.cache[6]===a[6]&&this.cache[7]===a[7]&&this.cache[8]===a[8]&&this.cache[9]===a[9]&&this.cache[10]===a[10]&&this.cache[11]===a[11]||(this.gl.uniformMatrix3x4fv(this.handle,!1,a),this.cache.set(a))},PicoGL.Mat4x2Uniform=function(a,b){this.gl=a,this.handle=b,this.cache=new Float32Array(8)},PicoGL.Mat4x2Uniform.prototype.set=function(a){this.cache[0]===a[0]&&this.cache[1]===a[1]&&this.cache[2]===a[2]&&this.cache[3]===a[3]&&this.cache[4]===a[4]&&this.cache[5]===a[5]&&this.cache[6]===a[6]&&this.cache[7]===a[7]||(this.gl.uniformMatrix4x2fv(this.handle,!1,a),this.cache.set(a))},PicoGL.Mat4x3Uniform=function(a,b){this.gl=a,this.handle=b,this.cache=new Float32Array(12)},PicoGL.Mat4x3Uniform.prototype.set=function(a){this.cache[0]===a[0]&&this.cache[1]===a[1]&&this.cache[2]===a[2]&&this.cache[3]===a[3]&&this.cache[4]===a[4]&&this.cache[5]===a[5]&&this.cache[6]===a[6]&&this.cache[7]===a[7]&&this.cache[8]===a[8]&&this.cache[9]===a[9]&&this.cache[10]===a[10]&&this.cache[11]===a[11]||(this.gl.uniformMatrix4x3fv(this.handle,!1,a),this.cache.set(a))}}(),function(){"use strict";PicoGL.UniformBuffer=function(a,b,c){this.gl=a,this.buffer=a.createBuffer(),this.dataViews={},this.offsets=new Array(b.length),this.sizes=new Array(b.length),this.types=new Array(b.length),this.size=0,this.usage=c||a.DYNAMIC_DRAW;for(var d=0,e=b.length;d<e;++d){var f=b[d];switch(f){case PicoGL.FLOAT:case PicoGL.INT:case PicoGL.UNSIGNED_INT:case PicoGL.BOOL:this.offsets[d]=this.size,this.sizes[d]=1,f===PicoGL.INT?this.types[d]=PicoGL.INT:this.type===PicoGL.UNSIGNED_INT?this.types[d]=PicoGL.UNSIGNED_INT:this.types[d]=PicoGL.FLOAT,this.size++;break;case PicoGL.FLOAT_VEC2:case PicoGL.INT_VEC2:case PicoGL.UNSIGNED_INT_VEC2:case PicoGL.BOOL_VEC2:this.size+=this.size%2,this.offsets[d]=this.size,this.sizes[d]=2,f===PicoGL.INT_VEC2?this.types[d]=PicoGL.INT:this.type===PicoGL.UNSIGNED_INT_VEC2?this.types[d]=PicoGL.UNSIGNED_INT:this.types[d]=PicoGL.FLOAT,this.size+=2;break;case PicoGL.FLOAT_VEC3:case PicoGL.INT_VEC3:case PicoGL.UNSIGNED_INT_VEC3:case PicoGL.BOOL_VEC3:case PicoGL.FLOAT_VEC4:case PicoGL.INT_VEC4:case PicoGL.UNSIGNED_INT_VEC4:case PicoGL.BOOL_VEC4:this.size+=(4-this.size%4)%4,this.offsets[d]=this.size,this.sizes[d]=4,f===PicoGL.INT_VEC4||f===PicoGL.INT_VEC3?this.types[d]=PicoGL.INT:this.type===PicoGL.UNSIGNED_INT_VEC4||this.type===PicoGL.UNSIGNED_INT_VEC3?this.types[d]=PicoGL.UNSIGNED_INT:this.types[d]=PicoGL.FLOAT,this.size+=4;break;case PicoGL.FLOAT_MAT2:case PicoGL.FLOAT_MAT2x3:case PicoGL.FLOAT_MAT2x4:this.size+=(4-this.size%4)%4,this.offsets[d]=this.size,this.sizes[d]=8,this.types[d]=PicoGL.FLOAT,this.size+=8;break;case PicoGL.FLOAT_MAT3:case PicoGL.FLOAT_MAT3x2:case PicoGL.FLOAT_MAT3x4:this.size+=(4-this.size%4)%4,this.offsets[d]=this.size,this.sizes[d]=12,this.types[d]=PicoGL.FLOAT,this.size+=12;break;case PicoGL.FLOAT_MAT4:case PicoGL.FLOAT_MAT4x2:case PicoGL.FLOAT_MAT4x3:this.size+=(4-this.size%4)%4,this.offsets[d]=this.size,this.sizes[d]=16,this.types[d]=PicoGL.FLOAT,this.size+=16;break;default:console.error("Unsupported type for uniform buffer.")}}this.size+=(4-this.size%4)%4,this.data=new Float32Array(this.size),this.dataViews[PicoGL.FLOAT]=this.data,this.dataViews[PicoGL.INT]=new Int32Array(this.data.buffer),this.dataViews[PicoGL.UNSIGNED_INT]=new Uint32Array(this.data.buffer),this.gl.bindBufferBase(this.gl.UNIFORM_BUFFER,0,this.buffer),this.gl.bufferData(this.gl.UNIFORM_BUFFER,4*this.size,this.usage),this.gl.bindBufferBase(this.gl.UNIFORM_BUFFER,0,null)},PicoGL.UniformBuffer.prototype.set=function(a,b){var c=this.dataViews[this.types[a]];return 1===this.sizes[a]?c[this.offsets[a]]=b:c.set(b,this.offsets[a]),this},PicoGL.UniformBuffer.prototype.update=function(){return this.gl.bindBufferBase(this.gl.UNIFORM_BUFFER,0,this.buffer),this.gl.bufferSubData(this.gl.UNIFORM_BUFFER,0,this.data),this.gl.bindBufferBase(this.gl.UNIFORM_BUFFER,0,null),this},PicoGL.UniformBuffer.prototype.delete=function(){this.buffer&&(this.gl.deleteBuffer(this.buffer),this.buffer=null)},PicoGL.UniformBuffer.prototype.bind=function(a){return this.gl.bindBufferBase(this.gl.UNIFORM_BUFFER,a,this.buffer),this}}(),function(){"use strict";PicoGL.Texture=function(a,b,c,d,e,f,g,h){h=h||PicoGL.DUMMY_OBJECT,d=d||h.width||0,e=e||h.height||0,f=f||h.depth||0,this.gl=a,this.binding=b,this.texture=a.createTexture(),this.format=h.format||a.RGBA,this.type=h.type||a.UNSIGNED_BYTE,this.internalFormat=h.internalFormat||PicoGL.TEXTURE_INTERNAL_FORMAT[this.type][this.format],this.is3D=g;var i=!c||!!c.BYTES_PER_ELEMENT,j=void 0===h.flipY||h.flipY,k=h.minFilter||a.LINEAR_MIPMAP_NEAREST,l=h.magFilter||a.LINEAR,m=h.wrapS||a.REPEAT,n=h.wrapT||a.REPEAT,o=h.wrapR||a.REPEAT,p=h.compareMode||a.NONE,q=h.compareFunc||a.LEQUAL,r=h.generateMipmaps!==!1&&(k===a.LINEAR_MIPMAP_NEAREST||k===a.LINEAR_MIPMAP_LINEAR);a.activeTexture(a.TEXTURE0),a.bindTexture(this.binding,this.texture),a.pixelStorei(a.UNPACK_FLIP_Y_WEBGL,j),a.texParameteri(this.binding,a.TEXTURE_MAG_FILTER,l),a.texParameteri(this.binding,a.TEXTURE_MIN_FILTER,k),a.texParameteri(this.binding,a.TEXTURE_WRAP_S,m),a.texParameteri(this.binding,a.TEXTURE_WRAP_T,n),a.texParameteri(this.binding,a.TEXTURE_COMPARE_FUNC,q),a.texParameteri(this.binding,a.TEXTURE_COMPARE_MODE,p),void 0!==h.baseLevel&&a.texParameteri(this.binding,a.TEXTURE_BASE_LEVEL,h.baseLevel),void 0!==h.maxLevel&&a.texParameteri(this.binding,a.TEXTURE_MAX_LEVEL,h.maxLevel),void 0!==h.minLOD&&a.texParameteri(this.binding,a.TEXTURE_MIN_LOD,h.minLOD),void 0!==h.maxLOD&&a.texParameteri(this.binding,a.TEXTURE_MAX_LOD,h.maxLOD),this.is3D?(a.texParameteri(this.binding,a.TEXTURE_WRAP_R,o),a.texImage3D(this.binding,0,this.internalFormat,d,e,f,0,this.format,this.type,c)):i?a.texImage2D(this.binding,0,this.internalFormat,d,e,0,this.format,this.type,c):a.texImage2D(this.binding,0,this.internalFormat,this.format,this.type,c),r&&a.generateMipmap(this.binding),a.bindTexture(this.binding,null)},PicoGL.Texture.prototype.image=function(a,b,c,d){return this.gl.activeTexture(this.gl.TEXTURE0),this.gl.bindTexture(this.binding,this.texture),this.is3D?this.gl.texImage3D(this.binding,0,this.internalFormat,b,c,d,0,this.format,this.type,a):a&&void 0===a.BYTES_PER_ELEMENT?this.gl.texImage2D(this.binding,0,this.internalFormat,this.format,this.type,a):this.gl.texImage2D(this.binding,0,this.internalFormat,b,c,0,this.format,this.type,a),this.gl.bindTexture(this.binding,null),this},PicoGL.Texture.prototype.delete=function(){this.texture&&(this.gl.deleteTexture(this.texture),this.texture=null)},PicoGL.Texture.prototype.bind=function(a){return this.gl.activeTexture(PicoGL.TEXTURE_UNIT_MAP[a]),this.gl.bindTexture(this.binding,this.texture),this}}(),function(){"use strict";PicoGL.Cubemap=function(a,b){b=b||PicoGL.DUMMY_OBJECT,this.gl=a,this.texture=a.createTexture(),this.format=b.format||a.RGBA,this.type=b.type||a.UNSIGNED_BYTE,this.internalFormat=b.internalFormat||PicoGL.TEXTURE_INTERNAL_FORMAT[this.type][this.format];var c=b.negX,d=b.posX,e=b.negY,f=b.posY,g=b.negZ,h=b.posZ,i=!c||!!c.BYTES_PER_ELEMENT,j=b.width||0,k=b.height||0,l=void 0!==b.flipY&&b.flipY,m=b.minFilter||a.LINEAR_MIPMAP_NEAREST,n=b.magFilter||a.LINEAR,o=b.wrapS||a.REPEAT,p=b.wrapT||a.REPEAT,q=b.generateMipmaps!==!1&&(m===a.LINEAR_MIPMAP_NEAREST||m===a.LINEAR_MIPMAP_LINEAR);a.activeTexture(a.TEXTURE0),a.bindTexture(a.TEXTURE_CUBE_MAP,this.texture),a.pixelStorei(a.UNPACK_FLIP_Y_WEBGL,l),a.texParameteri(a.TEXTURE_CUBE_MAP,a.TEXTURE_MAG_FILTER,n),a.texParameteri(a.TEXTURE_CUBE_MAP,a.TEXTURE_MIN_FILTER,m),a.texParameteri(a.TEXTURE_CUBE_MAP,a.TEXTURE_WRAP_S,o),a.texParameteri(a.TEXTURE_CUBE_MAP,a.TEXTURE_WRAP_T,p),i?(a.texImage2D(a.TEXTURE_CUBE_MAP_NEGATIVE_X,0,this.internalFormat,j,k,0,this.format,this.type,c),a.texImage2D(a.TEXTURE_CUBE_MAP_POSITIVE_X,0,this.internalFormat,j,k,0,this.format,this.type,d),a.texImage2D(a.TEXTURE_CUBE_MAP_NEGATIVE_Y,0,this.internalFormat,j,k,0,this.format,this.type,e),a.texImage2D(a.TEXTURE_CUBE_MAP_POSITIVE_Y,0,this.internalFormat,j,k,0,this.format,this.type,f),a.texImage2D(a.TEXTURE_CUBE_MAP_NEGATIVE_Z,0,this.internalFormat,j,k,0,this.format,this.type,g),a.texImage2D(a.TEXTURE_CUBE_MAP_POSITIVE_Z,0,this.internalFormat,j,k,0,this.format,this.type,h)):(a.texImage2D(a.TEXTURE_CUBE_MAP_NEGATIVE_X,0,this.internalFormat,this.format,this.type,c),a.texImage2D(a.TEXTURE_CUBE_MAP_POSITIVE_X,0,this.internalFormat,this.format,this.type,d),a.texImage2D(a.TEXTURE_CUBE_MAP_NEGATIVE_Y,0,this.internalFormat,this.format,this.type,e),a.texImage2D(a.TEXTURE_CUBE_MAP_POSITIVE_Y,0,this.internalFormat,this.format,this.type,f),a.texImage2D(a.TEXTURE_CUBE_MAP_NEGATIVE_Z,0,this.internalFormat,this.format,this.type,g),a.texImage2D(a.TEXTURE_CUBE_MAP_POSITIVE_Z,0,this.internalFormat,this.format,this.type,h)),q&&a.generateMipmap(a.TEXTURE_CUBE_MAP)},PicoGL.Cubemap.prototype.delete=function(){this.texture&&(this.gl.deleteTexture(this.texture),this.texture=null)},PicoGL.Cubemap.prototype.bind=function(a){return this.gl.activeTexture(PicoGL.TEXTURE_UNIT_MAP[a]),this.gl.bindTexture(this.gl.TEXTURE_CUBE_MAP,this.texture),this}}(),function(){"use strict";PicoGL.Framebuffer=function(a,b,c){this.gl=a,this.framebuffer=a.createFramebuffer(),b&&c?(this.width=b,this.height=c):(this.width=a.drawingBufferWidth,this.height=a.drawingBufferHeight),this.numColorTargets=0,this.colorTextures=[],this.colorAttachments=[],this.depthTexture=null},PicoGL.Framebuffer.prototype.colorTarget=function(a,b){return a=a||0,b=b||{},b.type=b.type||this.gl.UNSIGNED_BYTE,b.format=b.format||this.gl.RGBA,b.internalFormat=b.internalFormat||PicoGL.TEXTURE_INTERNAL_FORMAT[b.type][b.format],b.minFilter=b.minFilter||this.gl.NEAREST,b.magFilter=b.magFilter||this.gl.NEAREST,b.wrapS=b.wrapS||this.gl.CLAMP_TO_EDGE,b.wrapT=b.wrapT||this.gl.CLAMP_TO_EDGE,b.generateMipmaps=void 0!==b.generateMipmaps&&b.generateMipmaps,this.colorAttachments[a]=this.gl["COLOR_ATTACHMENT"+a],this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,this.framebuffer),this.colorTextures[a]=new PicoGL.Texture(this.gl,this.gl.TEXTURE_2D,null,this.width,this.height,null,!1,b),this.gl.framebufferTexture2D(this.gl.FRAMEBUFFER,this.colorAttachments[a],this.gl.TEXTURE_2D,this.colorTextures[a].texture,0),this.gl.drawBuffers(this.colorAttachments),this.numColorTargets++,this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,null),this},PicoGL.Framebuffer.prototype.depthTarget=function(a){return a=a||{},a.format=this.gl.DEPTH_COMPONENT,a.type=a.type||this.gl.UNSIGNED_SHORT,a.internalFormat=a.internalFormat||PicoGL.TEXTURE_INTERNAL_FORMAT[a.type][a.format],a.minFilter=a.minFilter||this.gl.NEAREST,a.magFilter=a.magFilter||this.gl.NEAREST,a.wrapS=a.wrapS||this.gl.CLAMP_TO_EDGE,a.wrapT=a.wrapT||this.gl.CLAMP_TO_EDGE,a.generateMipmaps=void 0!==a.generateMipmaps&&a.generateMipmaps,this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,this.framebuffer),this.depthTexture=new PicoGL.Texture(this.gl,this.gl.TEXTURE_2D,null,this.width,this.height,null,!1,a),this.gl.framebufferTexture2D(this.gl.FRAMEBUFFER,this.gl.DEPTH_ATTACHMENT,this.gl.TEXTURE_2D,this.depthTexture.texture,0),this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,null),this},PicoGL.Framebuffer.prototype.replaceTexture=function(a,b){return this.colorTextures[a]=b,this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,this.framebuffer),this.gl.framebufferTexture2D(this.gl.FRAMEBUFFER,this.colorAttachments[a],this.gl.TEXTURE_2D,this.colorTextures[a].texture,0),this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,null),this},PicoGL.Framebuffer.prototype.resize=function(a,b){a&&b?(this.width=a,this.height=b):(this.width=this.gl.drawingBufferWidth,this.height=this.gl.drawingBufferHeight),this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,this.framebuffer);for(var c=0;c<this.numColorTargets;++c)this.colorTextures[c].image(null,this.width,this.height);return this.depthTexture&&this.depthTexture.image(null,this.width,this.height),
this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,null),this},PicoGL.Framebuffer.prototype.delete=function(){for(var a=0;a<this.numColorTargets;++a)this.colorTextures[a].delete();this.depthTexture&&this.depthTexture.delete(),this.framebuffer&&(this.gl.deleteFramebuffer(this.framebuffer),this.framebuffer=null)}}(),function(){"use strict";PicoGL.DrawCall=function(a,b,c,d){this.gl=a,this.currentProgram=b,b.transformFeedback?(this.currentVertexArray=null,this.currentTransformFeedback=c):(this.currentVertexArray=c,this.currentTransformFeedback=null),this.uniformIndices={},this.uniformNames=new Array(PicoGL.WEBGL_INFO.MAX_UNIFORMS),this.uniformValues=new Array(PicoGL.WEBGL_INFO.MAX_UNIFORMS),this.uniformCount=0,this.uniformBuffers=new Array(PicoGL.WEBGL_INFO.MAX_UNIFORM_BUFFERS),this.uniformBlockNames=new Array(PicoGL.WEBGL_INFO.MAX_UNIFORM_BUFFERS),this.uniformBlockBases={},this.uniformBlockCount=0,this.textures=new Array(PicoGL.WEBGL_INFO.MAX_TEXTURE_UNITS),this.textureCount=0,this.primitive=void 0!==d?d:PicoGL.TRIANGLES},PicoGL.DrawCall.prototype.uniform=function(a,b){var c=this.uniformIndices[a];return void 0===c&&(c=this.uniformCount++,this.uniformIndices[a]=c,this.uniformNames[c]=a),this.uniformValues[c]=b,this},PicoGL.DrawCall.prototype.texture=function(a,b){var c,d=this.uniformIndices[a];return void 0===d?(c=this.textureCount++,this.uniform(a,c)):c=this.uniformValues[d],this.textures[c]=b,this},PicoGL.DrawCall.prototype.uniformBlock=function(a,b){var c=this.uniformBlockBases[a];return void 0===c&&(c=this.uniformBlockCount++,this.uniformBlockBases[a]=c,this.uniformBlockNames[c]=a),this.uniformBuffers[c]=b,this},PicoGL.DrawCall.prototype.draw=function(a){var b=this.uniformNames,c=this.uniformValues,d=this.uniformBuffers,e=this.uniformBlockNames,f=this.textures;a.program!==this.currentProgram&&(this.gl.useProgram(this.currentProgram.program),a.program=this.currentProgram);for(var g=0;g<this.uniformCount;++g)this.currentProgram.uniform(b[g],c[g]);for(var h=0;h<this.uniformBlockCount;++h)this.currentProgram.uniformBlock(e[h],h),d[h].bind(h);for(var i=0;i<this.textureCount;++i)f[i].bind(i);this.currentTransformFeedback&&(this.currentTransformFeedback.bind(this.primitive),this.currentVertexArray=this.currentTransformFeedback.inputVertexArray),a.vertexArray!==this.currentVertexArray&&(this.currentVertexArray.bind(),a.vertexArray=this.currentVertexArray),this.currentVertexArray.instanced?this.currentVertexArray.indexed?this.gl.drawElementsInstanced(this.primitive,this.currentVertexArray.numElements,this.currentVertexArray.indexType,0,this.currentVertexArray.numInstances):this.gl.drawArraysInstanced(this.primitive,0,this.currentVertexArray.numElements,this.currentVertexArray.numInstances):this.currentVertexArray.indexed?this.gl.drawElements(this.primitive,this.currentVertexArray.numElements,this.currentVertexArray.indexType,0):this.gl.drawArrays(this.primitive,0,this.currentVertexArray.numElements),this.currentTransformFeedback&&this.currentTransformFeedback.unbind()}}(),function(){"use strict";PicoGL.Timer=function(a){this.gl=a,this.cpuTimer=window.performance||window.Date,this.gpuTimer=this.gl.getExtension("EXT_disjoint_timer_query_webgl2")||null,this.gpuTimerQuery=null,this.gpuTimer&&(this.gpuTimerQuery=this.gl.createQuery()),this.gpuTimerQueryInProgress=!1,this.cpuStartTime=0,this.cpuTime=0,this.gpuTime=0},PicoGL.Timer.prototype.start=function(){this.gpuTimer?this.gpuTimerQueryInProgress||(this.gl.beginQuery(this.gpuTimer.TIME_ELAPSED_EXT,this.gpuTimerQuery),this.cpuStartTime=this.cpuTimer.now()):this.cpuStartTime=this.cpuTimer.now()},PicoGL.Timer.prototype.end=function(){this.gpuTimer?this.gpuTimerQueryInProgress||(this.gl.endQuery(this.gpuTimer.TIME_ELAPSED_EXT),this.cpuTime=this.cpuTimer.now()-this.cpuStartTime,this.gpuTimerQueryInProgress=!0):this.cpuTime=this.cpuTimer.now()-this.cpuStartTime},PicoGL.Timer.prototype.ready=function(){if(this.gpuTimer){if(!this.gpuTimerQueryInProgress)return!1;var a=this.gl.getQueryParameter(this.gpuTimerQuery,this.gl.QUERY_RESULT_AVAILABLE),b=this.gl.getParameter(this.gpuTimer.GPU_DISJOINT_EXT);return a&&(this.gpuTimerQueryInProgress=!1),!(!a||b)&&(this.gpuTime=this.gl.getQueryParameter(this.gpuTimerQuery,this.gl.QUERY_RESULT)/1e6,!0)}return!!this.cpuStartTime}}();