/*
PicoGL.js v0.4.0 

The MIT License (MIT)

Copyright (c) 2017 Tarek Sherif

Permission is hereby granted, free of charge, to any person obtaining a copy of
this software and associated documentation files (the "Software"), to deal in
the Software without restriction, including without limitation the rights to
use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of
the Software, and to permit persons to whom the Software is furnished to do so,
subject to the following conditions:

The above copyright notice and this permission notice shall be included in all
copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS
FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR
COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER
IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN
CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
*/

!function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){var c=b[g][1][a];return e(c||a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b,c){"use strict";function d(a,b){this.canvas=a,this.gl=a.getContext("webgl2",b),this.width=this.gl.drawingBufferWidth,this.height=this.gl.drawingBufferHeight,this.viewportWidth=this.width,this.viewportHeight=this.height,this.currentDrawCalls=null,this.emptyFragmentShader=null,this.state={program:null,vertexArray:null,transformFeedback:null,activeTexture:-1,textures:new Array(PicoGL.WEBGL_INFO.MAX_TEXTURE_UNITS),textureCount:0,freeTextureUnits:[],uniformBuffers:new Array(PicoGL.WEBGL_INFO.MAX_UNIFORM_BUFFERS),uniformBufferCount:0,freeUniformBufferBases:[],drawFramebuffer:null,readFramebuffer:null},this.clearBits=this.gl.COLOR_BUFFER_BIT|this.gl.DEPTH_BUFFER_BIT|this.gl.STENCIL_BUFFER_BIT,this.timer=new k(this.gl),this.cpuTime=0,this.gpuTime=0,this.floatRenderTargetsEnabled=!1,this.linearFloatTexturesEnabled=!1,this.gl.viewport(0,0,this.viewportWidth,this.viewportHeight)}var e=a("./cubemap"),f=a("./drawcall"),g=a("./framebuffer"),h=a("./program"),i=a("./shader"),j=a("./texture"),k=a("./timer"),l=a("./transformfeedback"),m=a("./uniformbuffer"),n=a("./vertexarray"),o=a("./vertexbuffer");d.prototype.colorMask=function(a,b,c,d){return this.gl.colorMask(a,b,c,d),this},d.prototype.clearColor=function(a,b,c,d){return this.gl.clearColor(a,b,c,d),this},d.prototype.clearMask=function(a){return this.clearBits=a,this},d.prototype.clear=function(){return this.gl.clear(this.clearBits),this},d.prototype.drawCalls=function(a){return this.currentDrawCalls=a,this},d.prototype.drawFramebuffer=function(a){return a.bindForDraw(),this.viewportWidth===a.width&&this.viewportHeight===a.height||(this.viewportWidth=a.width,this.viewportHeight=a.height,this.gl.viewport(0,0,this.viewportWidth,this.viewportHeight)),this},d.prototype.readFramebuffer=function(a){return a.bindForRead(),this},d.prototype.defaultDrawFramebuffer=function(){return null!==this.state.drawFramebuffer&&(this.gl.bindFramebuffer(this.gl.DRAW_FRAMEBUFFER,null),this.state.drawFramebuffer=null,this.viewportWidth===this.width&&this.viewportHeight===this.height||(this.viewportWidth=this.width,this.viewportHeight=this.height,this.gl.viewport(0,0,this.viewportWidth,this.viewportHeight))),this},d.prototype.defaultReadFramebuffer=function(){return null!==this.state.readFramebuffer&&(this.gl.bindFramebuffer(this.gl.READ_FRAMEBUFFER,null),this.state.readFramebuffer=null),this},d.prototype.depthRange=function(a,b){return this.gl.depthRange(a,b),this},d.prototype.depthTest=function(){return this.gl.enable(this.gl.DEPTH_TEST),this},d.prototype.noDepthTest=function(){return this.gl.disable(this.gl.DEPTH_TEST),this},d.prototype.depthMask=function(){return this.gl.depthMask(!0),this},d.prototype.noDepthMask=function(){return this.gl.depthMask(!1),this},d.prototype.depthFunc=function(a){return this.gl.depthFunc(a),this},d.prototype.blend=function(){return this.gl.enable(this.gl.BLEND),this},d.prototype.noBlend=function(){return this.gl.disable(this.gl.BLEND),this},d.prototype.blendFunc=function(a,b){return this.gl.blendFunc(a,b),this},d.prototype.blendFuncSeparate=function(a,b,c,d){return this.gl.blendFuncSeparate(a,b,c,d),this},d.prototype.stencilTest=function(){return this.gl.enable(this.gl.STENCIL_TEST),this},d.prototype.noStencilTest=function(){return this.gl.disable(this.gl.STENCIL_TEST),this},d.prototype.stencilMask=function(a){return this.gl.stencilMask(a),this},d.prototype.stencilMaskSeparate=function(a,b){return this.gl.stencilMaskSeparate(a,b),this},d.prototype.stencilFunc=function(a,b,c){return this.gl.stencilFunc(a,b,c),this},d.prototype.stencilFuncSeparate=function(a,b,c,d){return this.gl.stencilFuncSeparate(a,b,c,d),this},d.prototype.stencilOp=function(a,b,c){return this.gl.stencilOp(a,b,c),this},d.prototype.stencilOpSeparate=function(a,b,c,d){return this.gl.stencilOpSeparate(a,b,c,d),this},d.prototype.rasterize=function(){return this.gl.disable(this.gl.RASTERIZER_DISCARD),this},d.prototype.noRasterize=function(){return this.gl.enable(this.gl.RASTERIZER_DISCARD),this},d.prototype.cullBackfaces=function(){return this.gl.enable(this.gl.CULL_FACE),this},d.prototype.drawBackfaces=function(){return this.gl.disable(this.gl.CULL_FACE),this},d.prototype.floatRenderTargets=function(){return this.floatRenderTargetsEnabled=!!this.gl.getExtension("EXT_color_buffer_float"),this.floatRenderTargetsEnabled||console.warn("Extension EXT_color_buffer_float unavailable. Cannot enable float textures."),this},d.prototype.linearFloatTextures=function(){return this.linearFloatTexturesEnabled=!!this.gl.getExtension("OES_texture_float_linear"),this.linearFloatTexturesEnabled||console.warn("Extension OES_texture_float_linear unavailable. Cannot enable float texture linear filtering."),this},d.prototype.readPixel=function(a,b,c){return this.gl.readPixels(a,b,1,1,this.gl.RGBA,this.gl.UNSIGNED_BYTE,c),this},d.prototype.resize=function(a,b){return this.canvas.width=a,this.canvas.height=b,this.width=this.gl.drawingBufferWidth,this.height=this.gl.drawingBufferHeight,this.viewportWidth=this.width,this.viewportHeight=this.height,this.gl.viewport(0,0,this.viewportWidth,this.viewportHeight),this},d.prototype.createProgram=function(a,b,c){return new h(this.gl,a,b,c)},d.prototype.createShader=function(a,b){return new i(this.gl,a,b)},d.prototype.createVertexArray=function(){return new n(this.gl)},d.prototype.createTransformFeedback=function(){return new l(this.gl)},d.prototype.createVertexBuffer=function(a,b,c,d){return new o(this.gl,a,b,c,d)},d.prototype.createMatrixBuffer=function(a,b,c){return new o(this.gl,a,null,b,c)},d.prototype.createIndexBuffer=function(a,b,c){return new o(this.gl,a,b,c,null,!0)},d.prototype.createUniformBuffer=function(a,b){return new m(this.gl,a,b)},d.prototype.createTexture2D=function(a,b,c,d){return void 0===c&&(d=b,b=a.width,c=a.height),new j(this.gl,this.state,this.gl.TEXTURE_2D,a,b,c,null,!1,d)},d.prototype.createTextureArray=function(a,b,c,d,e){return new j(this.gl,this.state,this.gl.TEXTURE_2D_ARRAY,a,b,c,d,!0,e)},d.prototype.createTexture3D=function(a,b,c,d,e){return new j(this.gl,this.state,this.gl.TEXTURE_3D,a,b,c,d,!0,e)},d.prototype.createCubemap=function(a){return new e(this.gl,this.state,a)},d.prototype.createFramebuffer=function(a,b){return new g(this.gl,this.state,a,b)},d.prototype.createDrawCall=function(a,b,c){return new f(this.gl,a,b,c)},d.prototype.draw=function(){for(var a=0,b=this.currentDrawCalls.length;a<b;a++)this.currentDrawCalls[a].draw(this.state);return this},d.prototype.timerStart=function(){return this.timer.start(),this},d.prototype.timerEnd=function(){return this.timer.end(),this},d.prototype.timerReady=function(){return!!this.timer.ready()&&(this.cpuTime=this.timer.cpuTime,this.gpuTime=this.timer.gpuTime,!0)},b.exports=d},{"./cubemap":2,"./drawcall":3,"./framebuffer":4,"./program":6,"./shader":7,"./texture":8,"./timer":9,"./transformfeedback":10,"./uniformbuffer":11,"./vertexarray":13,"./vertexbuffer":14}],2:[function(a,b,c){"use strict";function d(a,b,c){c=c||PicoGL.DUMMY_OBJECT,this.gl=a,this.texture=a.createTexture(),this.format=void 0!==c.format?c.format:a.RGBA,this.type=void 0!==c.type?c.type:a.UNSIGNED_BYTE,this.internalFormat=void 0!==c.internalFormat?c.internalFormat:PicoGL.TEXTURE_INTERNAL_FORMAT[this.type][this.format],this.appState=b,b.freeTextureUnits.length>0?this.unit=b.freeTextureUnits.pop():(this.unit=b.textureCount%(b.textures.length-1),this.unit+=1,++b.textureCount),this.unitEnum=a.TEXTURE0+this.unit;var d=c.negX,e=c.posX,f=c.negY,g=c.posY,h=c.negZ,i=c.posZ,j=c.width||d.width,k=c.height||d.height,l=void 0!==c.flipY&&c.flipY,m=void 0!==c.minFilter?c.minFilter:a.LINEAR_MIPMAP_NEAREST,n=void 0!==c.magFilter?c.magFilter:a.LINEAR,o=void 0!==c.compareMode?c.compareMode:a.NONE,p=void 0!==c.compareFunc?c.compareFunc:a.LEQUAL,q=!1!==c.generateMipmaps&&(m===a.LINEAR_MIPMAP_NEAREST||m===a.LINEAR_MIPMAP_LINEAR);this.bind(),a.pixelStorei(a.UNPACK_FLIP_Y_WEBGL,l),a.texParameteri(a.TEXTURE_CUBE_MAP,a.TEXTURE_MAG_FILTER,n),a.texParameteri(a.TEXTURE_CUBE_MAP,a.TEXTURE_MIN_FILTER,m),a.texParameteri(a.TEXTURE_CUBE_MAP,a.TEXTURE_COMPARE_FUNC,p),a.texParameteri(a.TEXTURE_CUBE_MAP,a.TEXTURE_COMPARE_MODE,o),void 0!==c.baseLevel&&a.texParameteri(a.TEXTURE_CUBE_MAP,a.TEXTURE_BASE_LEVEL,c.baseLevel),void 0!==c.maxLevel&&a.texParameteri(a.TEXTURE_CUBE_MAP,a.TEXTURE_MAX_LEVEL,c.maxLevel),void 0!==c.minLOD&&a.texParameteri(a.TEXTURE_CUBE_MAP,a.TEXTURE_MIN_LOD,c.minLOD),void 0!==c.maxLOD&&a.texParameteri(a.TEXTURE_CUBE_MAP,a.TEXTURE_MAX_LOD,c.maxLOD);var r=q?Math.floor(Math.log2(Math.min(j,k)))+1:1;a.texStorage2D(a.TEXTURE_CUBE_MAP,r,this.internalFormat,j,k),a.texSubImage2D(a.TEXTURE_CUBE_MAP_NEGATIVE_X,0,0,0,j,k,this.format,this.type,d),a.texSubImage2D(a.TEXTURE_CUBE_MAP_POSITIVE_X,0,0,0,j,k,this.format,this.type,e),a.texSubImage2D(a.TEXTURE_CUBE_MAP_NEGATIVE_Y,0,0,0,j,k,this.format,this.type,f),a.texSubImage2D(a.TEXTURE_CUBE_MAP_POSITIVE_Y,0,0,0,j,k,this.format,this.type,g),a.texSubImage2D(a.TEXTURE_CUBE_MAP_NEGATIVE_Z,0,0,0,j,k,this.format,this.type,h),a.texSubImage2D(a.TEXTURE_CUBE_MAP_POSITIVE_Z,0,0,0,j,k,this.format,this.type,i),q&&a.generateMipmap(a.TEXTURE_CUBE_MAP)}d.prototype.delete=function(){this.texture&&(this.gl.deleteTexture(this.texture),this.texture=null,this.appState.freeTextureUnits.push(this.unit),this.appState.textures[this.unit]=null,this.unit=-1,this.unitEnum=-1)},d.prototype.bind=function(){return this.appState.activeTexture!==this.unit&&(this.gl.activeTexture(this.unitEnum),this.appState.activeTexture=this.unit),this.appState.textures[this.unit]!==this&&(this.gl.bindTexture(this.gl.TEXTURE_CUBE_MAP,this.texture),this.appState.textures[this.unit]=this),this},b.exports=d},{}],3:[function(a,b,c){"use strict";function d(a,b,c,d){this.gl=a,this.currentProgram=b,this.currentVertexArray=c,this.currentTransformFeedback=null,this.uniformIndices={},this.uniformNames=new Array(PicoGL.WEBGL_INFO.MAX_UNIFORMS),this.uniformValues=new Array(PicoGL.WEBGL_INFO.MAX_UNIFORMS),this.uniformCount=0,this.uniformBuffers=new Array(PicoGL.WEBGL_INFO.MAX_UNIFORM_BUFFERS),this.uniformBlockNames=new Array(PicoGL.WEBGL_INFO.MAX_UNIFORM_BUFFERS),this.uniformBlockBases={},this.uniformBlockCount=0,this.samplerIndices={},this.textures=new Array(PicoGL.WEBGL_INFO.MAX_TEXTURE_UNITS),this.textureCount=0,this.primitive=void 0!==d?d:PicoGL.TRIANGLES}d.prototype.transformFeedback=function(a){return this.currentTransformFeedback=a,this},d.prototype.uniform=function(a,b){var c=this.uniformIndices[a];return void 0===c&&(c=this.uniformCount++,this.uniformIndices[a]=c,this.uniformNames[c]=a),this.uniformValues[c]=b,this},d.prototype.texture=function(a,b){var c=this.samplerIndices[a];return void 0===c&&(c=this.textureCount++,this.samplerIndices[a]=c),this.uniform(a,b.unit),this.textures[c]=b,this},d.prototype.uniformBlock=function(a,b){var c=this.uniformBlockBases[a];return void 0===c&&(c=this.uniformBlockCount++,this.uniformBlockBases[a]=c,this.uniformBlockNames[c]=a),this.uniformBuffers[c]=b,this},d.prototype.draw=function(a){var b=this.uniformNames,c=this.uniformValues,d=this.uniformBuffers,e=this.uniformBlockNames,f=this.textures;a.program!==this.currentProgram&&(this.gl.useProgram(this.currentProgram.program),a.program=this.currentProgram);for(var g=0;g<this.uniformCount;++g)this.currentProgram.uniform(b[g],c[g]);for(var h=0;h<this.uniformBlockCount;++h)this.currentProgram.uniformBlock(e[h],h),d[h].bind(h);for(var i=0;i<this.textureCount;++i)f[i].bind();if(a.vertexArray!==this.currentVertexArray&&(this.currentVertexArray.bind(),a.vertexArray=this.currentVertexArray),this.currentTransformFeedback&&(a.transformFeedback!==this.currentTransformFeedback&&this.currentTransformFeedback.bind(),this.gl.beginTransformFeedback(this.primitive)),this.currentVertexArray.instanced?this.currentVertexArray.indexed?this.gl.drawElementsInstanced(this.primitive,this.currentVertexArray.numElements,this.currentVertexArray.indexType,0,this.currentVertexArray.numInstances):this.gl.drawArraysInstanced(this.primitive,0,this.currentVertexArray.numElements,this.currentVertexArray.numInstances):this.currentVertexArray.indexed?this.gl.drawElements(this.primitive,this.currentVertexArray.numElements,this.currentVertexArray.indexType,0):this.gl.drawArrays(this.primitive,0,this.currentVertexArray.numElements),this.currentTransformFeedback){this.gl.endTransformFeedback();for(var j=0,k=this.currentTransformFeedback.angleBugBuffers.length;j<k;++j)this.gl.bindBufferBase(this.gl.TRANSFORM_FEEDBACK_BUFFER,j,null)}},b.exports=d},{}],4:[function(a,b,c){"use strict";function d(a,b,c,d){this.gl=a,this.framebuffer=a.createFramebuffer(),this.appState=b,c&&d?(this.width=c,this.height=d):(this.width=a.drawingBufferWidth,this.height=a.drawingBufferHeight),this.numColorTargets=0,this.colorTextures=[],this.colorAttachments=[],this.depthTexture=null}var e=a("./texture");d.prototype.colorTarget=function(a,b){a=a||0,b=b||{},b.type=b.type||this.gl.UNSIGNED_BYTE,b.format=b.format||this.gl.RGBA,b.internalFormat=b.internalFormat||PicoGL.TEXTURE_INTERNAL_FORMAT[b.type][b.format],b.minFilter=b.minFilter||this.gl.NEAREST,b.magFilter=b.magFilter||this.gl.NEAREST,b.wrapS=b.wrapS||this.gl.CLAMP_TO_EDGE,b.wrapT=b.wrapT||this.gl.CLAMP_TO_EDGE,b.generateMipmaps=void 0!==b.generateMipmaps&&b.generateMipmaps,this.colorAttachments[a]=this.gl.COLOR_ATTACHMENT0+a;var c=this.bindAndCaptureState();return this.colorTextures[a]=new e(this.gl,this.appState,this.gl.TEXTURE_2D,null,this.width,this.height,null,!1,b),this.gl.framebufferTexture2D(this.gl.FRAMEBUFFER,this.colorAttachments[a],this.gl.TEXTURE_2D,this.colorTextures[a].texture,0),this.gl.drawBuffers(this.colorAttachments),this.numColorTargets++,this.restoreState(c),this},d.prototype.depthTarget=function(a){a=a||{},a.format=this.gl.DEPTH_COMPONENT,a.type=a.type||this.gl.UNSIGNED_SHORT,a.internalFormat=a.internalFormat||PicoGL.TEXTURE_INTERNAL_FORMAT[a.type][a.format],a.minFilter=a.minFilter||this.gl.NEAREST,a.magFilter=a.magFilter||this.gl.NEAREST,a.wrapS=a.wrapS||this.gl.CLAMP_TO_EDGE,a.wrapT=a.wrapT||this.gl.CLAMP_TO_EDGE,a.generateMipmaps=void 0!==a.generateMipmaps&&a.generateMipmaps;var b=this.bindAndCaptureState();return this.depthTexture=new e(this.gl,this.appState,this.gl.TEXTURE_2D,null,this.width,this.height,null,!1,a),this.gl.framebufferTexture2D(this.gl.DRAW_FRAMEBUFFER,this.gl.DEPTH_ATTACHMENT,this.gl.TEXTURE_2D,this.depthTexture.texture,0),this.restoreState(b),this},d.prototype.replaceTexture=function(a,b){this.colorTextures[a]=b;var c=this.bindAndCaptureState();return this.gl.framebufferTexture2D(this.gl.DRAW_FRAMEBUFFER,this.colorAttachments[a],this.gl.TEXTURE_2D,this.colorTextures[a].texture,0),this.restoreState(c),this},d.prototype.resize=function(a,b){a&&b?(this.width=a,this.height=b):(this.width=this.gl.drawingBufferWidth,this.height=this.gl.drawingBufferHeight);for(var c=this.bindAndCaptureState(),d=0;d<this.numColorTargets;++d)this.colorTextures[d].image(null,this.width,this.height),this.gl.framebufferTexture2D(this.gl.DRAW_FRAMEBUFFER,this.colorAttachments[d],this.gl.TEXTURE_2D,this.colorTextures[d].texture,0);return this.depthTexture&&(this.depthTexture.image(null,this.width,this.height),this.gl.framebufferTexture2D(this.gl.DRAW_FRAMEBUFFER,this.gl.DEPTH_ATTACHMENT,this.gl.TEXTURE_2D,this.depthTexture.texture,0)),this.restoreState(c),this},d.prototype.delete=function(){for(var a=0;a<this.numColorTargets;++a)this.colorTextures[a].delete();this.depthTexture&&this.depthTexture.delete(),this.framebuffer&&(this.gl.deleteFramebuffer(this.framebuffer),this.framebuffer=null)},d.prototype.bindForDraw=function(){this.appState.drawFramebuffer!==this&&(this.gl.bindFramebuffer(this.gl.DRAW_FRAMEBUFFER,this.framebuffer),this.appState.drawFramebuffer=this)},d.prototype.bindForRead=function(){this.appState.readFramebuffer!==this&&(this.gl.bindFramebuffer(this.gl.READ_FRAMEBUFFER,this.framebuffer),this.appState.readFramebuffer=this)},d.prototype.bindAndCaptureState=function(){var a=this.appState.drawFramebuffer;return a!==this&&this.gl.bindFramebuffer(this.gl.DRAW_FRAMEBUFFER,this.framebuffer),a},d.prototype.restoreState=function(a){a!==this&&this.gl.bindFramebuffer(this.gl.DRAW_FRAMEBUFFER,a?a.framebuffer:null)},b.exports=d},{"./texture":8}],5:[function(a,b,c){(function(c){"use strict";var d=a("./app"),e=c.PicoGL={version:"0.4.0"},f=document.createElement("canvas"),g=f.getContext("webgl2");if(g)for(var h in g)h.match(/^[A-Z0-9_x]+$/)&&"number"==typeof g[h]&&(e[h]=g[h]);e.TEXTURE_INTERNAL_FORMAT={};var i=e.TEXTURE_INTERNAL_FORMAT[g.UNSIGNED_BYTE]={};i[g.RED]=g.R8,i[g.RG]=g.RG8,i[g.RGB]=g.RGB8,i[g.RGBA]=g.RGBA8,(e.TEXTURE_INTERNAL_FORMAT[g.UNSIGNED_SHORT]={})[g.DEPTH_COMPONENT]=g.DEPTH_COMPONENT16;var j=e.TEXTURE_INTERNAL_FORMAT[g.FLOAT]={};j[g.RED]=g.R16F,j[g.RG]=g.RG16F,j[g.RGB]=g.RGB16F,j[g.RGBA]=g.RGBA16F,j[g.DEPTH_COMPONENT]=g.DEPTH_COMPONENT32F,e.TYPE_SIZE={},e.TYPE_SIZE[g.BYTE]=1,e.TYPE_SIZE[g.UNSIGNED_BYTE]=1,e.TYPE_SIZE[g.SHORT]=2,e.TYPE_SIZE[g.UNSIGNED_SHORT]=2,e.TYPE_SIZE[g.INT]=4,e.TYPE_SIZE[g.UNSIGNED_INT]=4,e.TYPE_SIZE[g.FLOAT]=4,e.UNIFORM_FUNC_NAME={},e.UNIFORM_FUNC_NAME[g.BOOL]="uniform1i",e.UNIFORM_FUNC_NAME[g.INT]="uniform1i",e.UNIFORM_FUNC_NAME[g.SAMPLER_2D]="uniform1i",e.UNIFORM_FUNC_NAME[g.INT_SAMPLER_2D]="uniform1i",e.UNIFORM_FUNC_NAME[g.UNSIGNED_INT_SAMPLER_2D]="uniform1i",e.UNIFORM_FUNC_NAME[g.SAMPLER_2D_SHADOW]="uniform1i",e.UNIFORM_FUNC_NAME[g.SAMPLER_2D_ARRAY]="uniform1i",e.UNIFORM_FUNC_NAME[g.INT_SAMPLER_2D_ARRAY]="uniform1i",e.UNIFORM_FUNC_NAME[g.UNSIGNED_INT_SAMPLER_2D_ARRAY]="uniform1i",e.UNIFORM_FUNC_NAME[g.SAMPLER_2D_ARRAY_SHADOW]="uniform1i",e.UNIFORM_FUNC_NAME[g.SAMPLER_CUBE]="uniform1i",e.UNIFORM_FUNC_NAME[g.INT_SAMPLER_CUBE]="uniform1i",e.UNIFORM_FUNC_NAME[g.UNSIGNED_INT_SAMPLER_CUBE]="uniform1i",e.UNIFORM_FUNC_NAME[g.SAMPLER_CUBE_SHADOW]="uniform1i",e.UNIFORM_FUNC_NAME[g.SAMPLER_3D]="uniform1i",e.UNIFORM_FUNC_NAME[g.INT_SAMPLER_3D]="uniform1i",e.UNIFORM_FUNC_NAME[g.UNSIGNED_INT_SAMPLER_3D]="uniform1i",e.UNIFORM_FUNC_NAME[g.UNSIGNED_INT]="uniform1ui",e.UNIFORM_FUNC_NAME[g.FLOAT]="uniform1f",e.UNIFORM_FUNC_NAME[g.FLOAT_VEC2]="uniform2f",e.UNIFORM_FUNC_NAME[g.FLOAT_VEC3]="uniform3f",e.UNIFORM_FUNC_NAME[g.FLOAT_VEC4]="uniform4f",e.UNIFORM_FUNC_NAME[g.INT_VEC2]="uniform2i",e.UNIFORM_FUNC_NAME[g.INT_VEC3]="uniform3i",e.UNIFORM_FUNC_NAME[g.INT_VEC4]="uniform4i",e.UNIFORM_FUNC_NAME[g.UNSIGNED_INT_VEC2]="uniform2ui",e.UNIFORM_FUNC_NAME[g.UNSIGNED_INT_VEC3]="uniform3ui",e.UNIFORM_FUNC_NAME[g.UNSIGNED_INT_VEC4]="uniform4ui",e.UNIFORM_FUNC_NAME[g.BOOL_VEC2]="uniform2i",e.UNIFORM_FUNC_NAME[g.BOOL_VEC3]="uniform3i",e.UNIFORM_FUNC_NAME[g.BOOL_VEC4]="uniform4i",e.UNIFORM_FUNC_NAME[g.FLOAT_MAT2]="uniformMatrix2fv",e.UNIFORM_FUNC_NAME[g.FLOAT_MAT3]="uniformMatrix3fv",e.UNIFORM_FUNC_NAME[g.FLOAT_MAT4]="uniformMatrix4fv",e.UNIFORM_FUNC_NAME[g.FLOAT_MAT2x3]="uniformMatrix2x3fv",e.UNIFORM_FUNC_NAME[g.FLOAT_MAT2x4]="uniformMatrix2x4fv",e.UNIFORM_FUNC_NAME[g.FLOAT_MAT3x2]="uniformMatrix3x2fv",e.UNIFORM_FUNC_NAME[g.FLOAT_MAT3x4]="uniformMatrix3x4fv",e.UNIFORM_FUNC_NAME[g.FLOAT_MAT4x2]="uniformMatrix4x2fv",e.UNIFORM_FUNC_NAME[g.FLOAT_MAT4x3]="uniformMatrix4x3fv",e.UNIFORM_COMPONENT_COUNT={},e.UNIFORM_COMPONENT_COUNT[g.BOOL]=1,e.UNIFORM_COMPONENT_COUNT[g.INT]=1,e.UNIFORM_COMPONENT_COUNT[g.SAMPLER_2D]=1,e.UNIFORM_COMPONENT_COUNT[g.INT_SAMPLER_2D]=1,e.UNIFORM_COMPONENT_COUNT[g.UNSIGNED_INT_SAMPLER_2D]=1,e.UNIFORM_COMPONENT_COUNT[g.SAMPLER_2D_SHADOW]=1,e.UNIFORM_COMPONENT_COUNT[g.SAMPLER_2D_ARRAY]=1,e.UNIFORM_COMPONENT_COUNT[g.INT_SAMPLER_2D_ARRAY]=1,e.UNIFORM_COMPONENT_COUNT[g.UNSIGNED_INT_SAMPLER_2D_ARRAY]=1,e.UNIFORM_COMPONENT_COUNT[g.SAMPLER_2D_ARRAY_SHADOW]=1,e.UNIFORM_COMPONENT_COUNT[g.SAMPLER_CUBE]=1,e.UNIFORM_COMPONENT_COUNT[g.INT_SAMPLER_CUBE]=1,e.UNIFORM_COMPONENT_COUNT[g.UNSIGNED_INT_SAMPLER_CUBE]=1,e.UNIFORM_COMPONENT_COUNT[g.SAMPLER_CUBE_SHADOW]=1,e.UNIFORM_COMPONENT_COUNT[g.SAMPLER_3D]=1,e.UNIFORM_COMPONENT_COUNT[g.INT_SAMPLER_3D]=1,e.UNIFORM_COMPONENT_COUNT[g.UNSIGNED_INT_SAMPLER_3D]=1,e.UNIFORM_COMPONENT_COUNT[g.UNSIGNED_INT]=1,e.UNIFORM_COMPONENT_COUNT[g.FLOAT]=1,e.UNIFORM_COMPONENT_COUNT[g.FLOAT_VEC2]=2,e.UNIFORM_COMPONENT_COUNT[g.FLOAT_VEC3]=3,e.UNIFORM_COMPONENT_COUNT[g.FLOAT_VEC4]=4,e.UNIFORM_COMPONENT_COUNT[g.INT_VEC2]=2,e.UNIFORM_COMPONENT_COUNT[g.INT_VEC3]=3,e.UNIFORM_COMPONENT_COUNT[g.INT_VEC4]=4,e.UNIFORM_COMPONENT_COUNT[g.UNSIGNED_INT_VEC2]=2,e.UNIFORM_COMPONENT_COUNT[g.UNSIGNED_INT_VEC3]=3,e.UNIFORM_COMPONENT_COUNT[g.UNSIGNED_INT_VEC4]=4,e.UNIFORM_COMPONENT_COUNT[g.BOOL_VEC2]=2,e.UNIFORM_COMPONENT_COUNT[g.BOOL_VEC3]=3,e.UNIFORM_COMPONENT_COUNT[g.BOOL_VEC4]=4,e.UNIFORM_COMPONENT_COUNT[g.FLOAT_MAT2]=4,e.UNIFORM_COMPONENT_COUNT[g.FLOAT_MAT3]=9,e.UNIFORM_COMPONENT_COUNT[g.FLOAT_MAT4]=16,e.UNIFORM_COMPONENT_COUNT[g.FLOAT_MAT2x3]=6,e.UNIFORM_COMPONENT_COUNT[g.FLOAT_MAT2x4]=8,e.UNIFORM_COMPONENT_COUNT[g.FLOAT_MAT3x2]=6,e.UNIFORM_COMPONENT_COUNT[g.FLOAT_MAT3x4]=12,e.UNIFORM_COMPONENT_COUNT[g.FLOAT_MAT4x2]=8,e.UNIFORM_COMPONENT_COUNT[g.FLOAT_MAT4x3]=12,e.UNIFORM_CACHE_CLASS={},e.UNIFORM_CACHE_CLASS[g.INT]=Int32Array,e.UNIFORM_CACHE_CLASS[g.SAMPLER_2D]=Int32Array,e.UNIFORM_CACHE_CLASS[g.INT_SAMPLER_2D]=Int32Array,e.UNIFORM_CACHE_CLASS[g.UNSIGNED_INT_SAMPLER_2D]=Int32Array,e.UNIFORM_CACHE_CLASS[g.SAMPLER_2D_SHADOW]=Int32Array,e.UNIFORM_CACHE_CLASS[g.SAMPLER_2D_ARRAY]=Int32Array,e.UNIFORM_CACHE_CLASS[g.INT_SAMPLER_2D_ARRAY]=Int32Array,e.UNIFORM_CACHE_CLASS[g.UNSIGNED_INT_SAMPLER_2D_ARRAY]=Int32Array,e.UNIFORM_CACHE_CLASS[g.SAMPLER_2D_ARRAY_SHADOW]=Int32Array,e.UNIFORM_CACHE_CLASS[g.SAMPLER_CUBE]=Int32Array,e.UNIFORM_CACHE_CLASS[g.INT_SAMPLER_CUBE]=Int32Array,e.UNIFORM_CACHE_CLASS[g.UNSIGNED_INT_SAMPLER_CUBE]=Int32Array,e.UNIFORM_CACHE_CLASS[g.SAMPLER_CUBE_SHADOW]=Int32Array,e.UNIFORM_CACHE_CLASS[g.SAMPLER_3D]=Int32Array,e.UNIFORM_CACHE_CLASS[g.INT_SAMPLER_3D]=Int32Array,e.UNIFORM_CACHE_CLASS[g.UNSIGNED_INT_SAMPLER_3D]=Int32Array,e.UNIFORM_CACHE_CLASS[g.UNSIGNED_INT]=Uint32Array,e.UNIFORM_CACHE_CLASS[g.FLOAT]=Float32Array,e.UNIFORM_CACHE_CLASS[g.FLOAT_VEC2]=Float32Array,e.UNIFORM_CACHE_CLASS[g.FLOAT_VEC3]=Float32Array,e.UNIFORM_CACHE_CLASS[g.FLOAT_VEC4]=Float32Array,e.UNIFORM_CACHE_CLASS[g.INT_VEC2]=Int32Array,e.UNIFORM_CACHE_CLASS[g.INT_VEC3]=Int32Array,e.UNIFORM_CACHE_CLASS[g.INT_VEC4]=Int32Array,e.UNIFORM_CACHE_CLASS[g.UNSIGNED_INT_VEC2]=Uint32Array,e.UNIFORM_CACHE_CLASS[g.UNSIGNED_INT_VEC3]=Uint32Array,e.UNIFORM_CACHE_CLASS[g.UNSIGNED_INT_VEC4]=Uint32Array,e.WEBGL_INFO={},e.WEBGL_INFO.MAX_TEXTURE_UNITS=g.getParameter(g.MAX_COMBINED_TEXTURE_IMAGE_UNITS),e.WEBGL_INFO.MAX_UNIFORM_BUFFERS=g.getParameter(g.MAX_UNIFORM_BUFFER_BINDINGS),e.DUMMY_OBJECT={},e.createApp=function(a,b){return new d(a,b)},b.exports=e}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./app":1}],6:[function(a,b,c){"use strict";function d(a,b,c,d){var g,h,i,j=!1,k=!1;"string"==typeof b?(h=new e(a,a.VERTEX_SHADER,b),j=!0):h=b,"string"==typeof c?(i=new e(a,a.FRAGMENT_SHADER,c),k=!0):i=c;var l=a.createProgram();a.attachShader(l,h.shader),a.attachShader(l,i.shader),d&&a.transformFeedbackVaryings(l,d,a.SEPARATE_ATTRIBS),a.linkProgram(l),a.getProgramParameter(l,a.LINK_STATUS)||console.error(a.getProgramInfoLog(l)),j&&h.delete(),k&&i.delete(),this.gl=a,this.program=l,this.transformFeedback=!!d,this.uniforms={},this.uniformBlocks={},this.uniformBlockBindings={};var m=a.getProgramParameter(l,a.ACTIVE_UNIFORMS);for(g=0;g<m;++g){var n=a.getActiveUniform(l,g),o=a.getUniformLocation(this.program,n.name),p=null,q=n.type,r=n.size;switch(q){case PicoGL.INT:case PicoGL.SAMPLER_2D:case PicoGL.INT_SAMPLER_2D:case PicoGL.UNSIGNED_INT_SAMPLER_2D:case PicoGL.SAMPLER_2D_SHADOW:case PicoGL.SAMPLER_2D_ARRAY:case PicoGL.INT_SAMPLER_2D_ARRAY:case PicoGL.UNSIGNED_INT_SAMPLER_2D_ARRAY:case PicoGL.SAMPLER_2D_ARRAY_SHADOW:case PicoGL.SAMPLER_CUBE:case PicoGL.INT_SAMPLER_CUBE:case PicoGL.UNSIGNED_INT_SAMPLER_CUBE:case PicoGL.SAMPLER_CUBE_SHADOW:case PicoGL.SAMPLER_3D:case PicoGL.INT_SAMPLER_3D:case PicoGL.UNSIGNED_INT_SAMPLER_3D:case PicoGL.UNSIGNED_INT:case PicoGL.FLOAT:p=r>1?f.MultiNumericUniform:f.SingleComponentUniform;break;case PicoGL.BOOL:p=r>1?f.MultiBoolUniform:f.SingleComponentUniform;break;case PicoGL.FLOAT_VEC2:case PicoGL.INT_VEC2:case PicoGL.UNSIGNED_INT_VEC2:case PicoGL.FLOAT_VEC3:case PicoGL.INT_VEC3:case PicoGL.UNSIGNED_INT_VEC3:case PicoGL.FLOAT_VEC4:case PicoGL.INT_VEC4:case PicoGL.UNSIGNED_INT_VEC4:p=f.MultiNumericUniform;break;case PicoGL.BOOL_VEC2:case PicoGL.BOOL_VEC3:case PicoGL.BOOL_VEC4:p=f.MultiBoolUniform;break;case PicoGL.FLOAT_MAT2:case PicoGL.FLOAT_MAT3:case PicoGL.FLOAT_MAT4:case PicoGL.FLOAT_MAT2x3:case PicoGL.FLOAT_MAT2x4:case PicoGL.FLOAT_MAT3x2:case PicoGL.FLOAT_MAT3x4:case PicoGL.FLOAT_MAT4x2:case PicoGL.FLOAT_MAT4x3:p=f.MatrixUniform;break;default:console.error("Unrecognized type for uniform ",n.name)}this.uniforms[n.name]=new p(a,o,q,r)}var s=a.getProgramParameter(l,a.ACTIVE_UNIFORM_BLOCKS);for(g=0;g<s;++g){var t=a.getActiveUniformBlockName(this.program,g),u=a.getUniformBlockIndex(this.program,t);this.uniformBlocks[t]=u}}var e=a("./shader"),f=a("./uniforms");d.prototype.delete=function(){this.program&&(this.gl.deleteProgram(this.program),this.program=null)},d.prototype.uniform=function(a,b){this.uniforms[a].set(b)},d.prototype.uniformBlock=function(a,b){this.uniformBlockBindings[a]!==b&&(this.gl.uniformBlockBinding(this.program,this.uniformBlocks[a],b),this.uniformBlockBindings[a]=b)},b.exports=d},{"./shader":7,"./uniforms":12}],7:[function(a,b,c){"use strict";function d(a,b,c){if(this.gl=a,this.shader=a.createShader(b),a.shaderSource(this.shader,c),a.compileShader(this.shader),!a.getShaderParameter(this.shader,a.COMPILE_STATUS)){var d,e;for(console.error(a.getShaderInfoLog(this.shader)),e=c.split("\n"),d=0;d<e.length;++d)console.error(d+1+":",e[d])}}d.prototype.delete=function(){this.shader&&(this.gl.deleteShader(this.shader),this.shader=null)},b.exports=d},{}],8:[function(a,b,c){"use strict";function d(a,b,c,d,e,f,g,h,i){i=i||PicoGL.DUMMY_OBJECT,this.gl=a,this.binding=c,this.texture=a.createTexture(),this.width=-1,this.height=-1,this.depth=-1,this.format=void 0!==i.format?i.format:a.RGBA,this.type=void 0!==i.type?i.type:a.UNSIGNED_BYTE,this.internalFormat=void 0!==i.internalFormat?i.internalFormat:PicoGL.TEXTURE_INTERNAL_FORMAT[this.type][this.format],this.is3D=h,this.appState=b,b.freeTextureUnits.length>0?this.unit=b.freeTextureUnits.pop():(this.unit=b.textureCount%(b.textures.length-1),this.unit+=1,++b.textureCount),this.unitEnum=a.TEXTURE0+this.unit;var j=void 0!==i.minFilter?i.minFilter:a.LINEAR_MIPMAP_NEAREST,k=void 0!==i.magFilter?i.magFilter:a.LINEAR,l=void 0!==i.wrapS?i.wrapS:a.REPEAT,m=void 0!==i.wrapT?i.wrapT:a.REPEAT,n=void 0!==i.wrapR?i.wrapR:a.REPEAT,o=void 0!==i.compareMode?i.compareMode:a.NONE,p=void 0!==i.compareFunc?i.compareFunc:a.LEQUAL,q=void 0!==i.minLOD?i.minLOD:null,r=void 0!==i.maxLOD?i.maxLOD:null;this.sampler=a.createSampler(),a.samplerParameteri(this.sampler,a.TEXTURE_MIN_FILTER,j),a.samplerParameteri(this.sampler,a.TEXTURE_MAG_FILTER,k),a.samplerParameteri(this.sampler,a.TEXTURE_WRAP_S,l),a.samplerParameteri(this.sampler,a.TEXTURE_WRAP_T,m),a.samplerParameteri(this.sampler,a.TEXTURE_WRAP_R,n),a.samplerParameteri(this.sampler,a.TEXTURE_COMPARE_FUNC,p),a.samplerParameteri(this.sampler,a.TEXTURE_COMPARE_MODE,o),null!==q&&a.samplerParameterf(this.sampler,a.TEXTURE_MIN_LOD,q),null!==r&&a.samplerParameterf(this.sampler,a.TEXTURE_MAX_LOD,r),this.flipY=void 0!==i.flipY&&i.flipY,this.baseLevel=void 0!==i.baseLevel?i.baseLevel:null,this.maxLevel=void 0!==i.maxLevel?i.maxLevel:null,this.generateMipmaps=!1!==i.generateMipmaps&&(j===a.LINEAR_MIPMAP_NEAREST||j===a.LINEAR_MIPMAP_LINEAR),this.bind(!0),a.bindSampler(this.unit,this.sampler),this.image(d,e,f,g)}d.prototype.image=function(a,b,c,d){return b=b||a.width,c=c||a.height,d=d||0,b===this.width&&c===this.height&&d===this.depth||(this.gl.deleteTexture(this.texture),this.texture=this.gl.createTexture(),this.bind(!0),this.width=b||a.width,this.height=c||a.height,this.depth=d||0,this.allocateStorage()),a&&(this.is3D?this.gl.texSubImage3D(this.binding,0,0,0,0,this.width,this.height,this.depth,this.format,this.type,a):this.gl.texSubImage2D(this.binding,0,0,0,this.width,this.height,this.format,this.type,a),this.generateMipmaps&&this.gl.generateMipmap(this.binding)),this},d.prototype.delete=function(){this.texture&&(this.gl.deleteTexture(this.texture),this.gl.deleteSampler(this.sampler),this.texture=null,this.sampler=null,this.appState.freeTextureUnits.push(this.unit),this.appState.textures[this.unit]=null,this.unit=-1,this.unitEnum=-1)},d.prototype.allocateStorage=function(){this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,this.flipY),null!==this.baseLevel&&this.gl.texParameteri(this.binding,this.gl.TEXTURE_BASE_LEVEL,this.baseLevel),null!==this.maxLevel&&this.gl.texParameteri(this.binding,this.gl.TEXTURE_MAX_LEVEL,this.maxLevel);var a;this.is3D?(a=this.generateMipmaps?Math.floor(Math.log2(Math.max(Math.max(this.width,this.height),this.depth)))+1:1,this.gl.texStorage3D(this.binding,a,this.internalFormat,this.width,this.height,this.depth)):(a=this.generateMipmaps?Math.floor(Math.log2(Math.max(this.width,this.height)))+1:1,this.gl.texStorage2D(this.binding,a,this.internalFormat,this.width,this.height))},d.prototype.activateUnit=function(){return this.appState.activeTexture!==this.unit&&(this.gl.activeTexture(this.unitEnum),this.appState.activeTexture=this.unit),this},d.prototype.bind=function(a){return(a||this.appState.textures[this.unit]!==this)&&(this.activateUnit(),this.gl.bindTexture(this.binding,this.texture),this.appState.textures[this.unit]=this),this},b.exports=d},{}],9:[function(a,b,c){"use strict";function d(a){this.gl=a,this.cpuTimer=window.performance||window.Date;var b=this.gl.getExtension("EXT_disjoint_timer_query_webgl2")||this.gl.getExtension("EXT_disjoint_timer_query");b?(this.gpuTimer=!0,this.gpuTimerQuery=this.gl.createQuery(),this.TIME_ELAPSED_EXT=b.TIME_ELAPSED_EXT,this.GPU_DISJOINT_EXT=b.GPU_DISJOINT_EXT):(this.gpuTimer=!1,this.gpuTimerQuery=null,this.TIME_ELAPSED_EXT=null,this.GPU_DISJOINT_EXT=null),this.gpuTimerQueryInProgress=!1,this.cpuStartTime=0,this.cpuTime=0,this.gpuTime=0}d.prototype.start=function(){this.gpuTimer?this.gpuTimerQueryInProgress||(this.gl.beginQuery(this.TIME_ELAPSED_EXT,this.gpuTimerQuery),this.cpuStartTime=this.cpuTimer.now()):this.cpuStartTime=this.cpuTimer.now()},d.prototype.end=function(){this.gpuTimer?this.gpuTimerQueryInProgress||(this.gl.endQuery(this.TIME_ELAPSED_EXT),this.cpuTime=this.cpuTimer.now()-this.cpuStartTime,this.gpuTimerQueryInProgress=!0):this.cpuTime=this.cpuTimer.now()-this.cpuStartTime},d.prototype.ready=function(){if(this.gpuTimer){if(!this.gpuTimerQueryInProgress)return!1;var a=this.gl.getQueryParameter(this.gpuTimerQuery,this.gl.QUERY_RESULT_AVAILABLE),b=this.gl.getParameter(this.GPU_DISJOINT_EXT);return a&&(this.gpuTimerQueryInProgress=!1),!(!a||b)&&(this.gpuTime=this.gl.getQueryParameter(this.gpuTimerQuery,this.gl.QUERY_RESULT)/1e6,!0)}return!!this.cpuStartTime},b.exports=d},{}],10:[function(a,b,c){"use strict";function d(a){this.gl=a,this.transformFeedback=a.createTransformFeedback(),this.angleBugBuffers=[]}d.prototype.feedbackBuffer=function(a,b){return this.gl.bindTransformFeedback(this.gl.TRANSFORM_FEEDBACK,this.transformFeedback),this.gl.bindBufferBase(this.gl.TRANSFORM_FEEDBACK_BUFFER,a,b.buffer),this.gl.bindTransformFeedback(this.gl.TRANSFORM_FEEDBACK,null),this.gl.bindBufferBase(this.gl.TRANSFORM_FEEDBACK_BUFFER,a,null),this.angleBugBuffers[a]=b,this},d.prototype.delete=function(){
this.transformFeedback&&(this.gl.deleteTransformFeedback(this.transformFeedback),this.transformFeedback=null)},d.prototype.bind=function(){this.gl.bindTransformFeedback(this.gl.TRANSFORM_FEEDBACK,this.transformFeedback);for(var a=0,b=this.angleBugBuffers.length;a<b;++a)this.gl.bindBufferBase(this.gl.TRANSFORM_FEEDBACK_BUFFER,a,this.angleBugBuffers[a].buffer);return this},b.exports=d},{}],11:[function(a,b,c){"use strict";function d(a,b,c){this.gl=a,this.buffer=a.createBuffer(),this.dataViews={},this.offsets=new Array(b.length),this.sizes=new Array(b.length),this.types=new Array(b.length),this.size=0,this.usage=c||a.DYNAMIC_DRAW;for(var d=0,e=b.length;d<e;++d){var f=b[d];switch(f){case PicoGL.FLOAT:case PicoGL.INT:case PicoGL.UNSIGNED_INT:case PicoGL.BOOL:this.offsets[d]=this.size,this.sizes[d]=1,f===PicoGL.INT?this.types[d]=PicoGL.INT:this.type===PicoGL.UNSIGNED_INT?this.types[d]=PicoGL.UNSIGNED_INT:this.types[d]=PicoGL.FLOAT,this.size++;break;case PicoGL.FLOAT_VEC2:case PicoGL.INT_VEC2:case PicoGL.UNSIGNED_INT_VEC2:case PicoGL.BOOL_VEC2:this.size+=this.size%2,this.offsets[d]=this.size,this.sizes[d]=2,f===PicoGL.INT_VEC2?this.types[d]=PicoGL.INT:this.type===PicoGL.UNSIGNED_INT_VEC2?this.types[d]=PicoGL.UNSIGNED_INT:this.types[d]=PicoGL.FLOAT,this.size+=2;break;case PicoGL.FLOAT_VEC3:case PicoGL.INT_VEC3:case PicoGL.UNSIGNED_INT_VEC3:case PicoGL.BOOL_VEC3:case PicoGL.FLOAT_VEC4:case PicoGL.INT_VEC4:case PicoGL.UNSIGNED_INT_VEC4:case PicoGL.BOOL_VEC4:this.size+=(4-this.size%4)%4,this.offsets[d]=this.size,this.sizes[d]=4,f===PicoGL.INT_VEC4||f===PicoGL.INT_VEC3?this.types[d]=PicoGL.INT:this.type===PicoGL.UNSIGNED_INT_VEC4||this.type===PicoGL.UNSIGNED_INT_VEC3?this.types[d]=PicoGL.UNSIGNED_INT:this.types[d]=PicoGL.FLOAT,this.size+=4;break;case PicoGL.FLOAT_MAT2:case PicoGL.FLOAT_MAT2x3:case PicoGL.FLOAT_MAT2x4:this.size+=(4-this.size%4)%4,this.offsets[d]=this.size,this.sizes[d]=8,this.types[d]=PicoGL.FLOAT,this.size+=8;break;case PicoGL.FLOAT_MAT3:case PicoGL.FLOAT_MAT3x2:case PicoGL.FLOAT_MAT3x4:this.size+=(4-this.size%4)%4,this.offsets[d]=this.size,this.sizes[d]=12,this.types[d]=PicoGL.FLOAT,this.size+=12;break;case PicoGL.FLOAT_MAT4:case PicoGL.FLOAT_MAT4x2:case PicoGL.FLOAT_MAT4x3:this.size+=(4-this.size%4)%4,this.offsets[d]=this.size,this.sizes[d]=16,this.types[d]=PicoGL.FLOAT,this.size+=16;break;default:console.error("Unsupported type for uniform buffer.")}}this.size+=(4-this.size%4)%4,this.data=new Float32Array(this.size),this.dataViews[PicoGL.FLOAT]=this.data,this.dataViews[PicoGL.INT]=new Int32Array(this.data.buffer),this.dataViews[PicoGL.UNSIGNED_INT]=new Uint32Array(this.data.buffer),this.gl.bindBufferBase(this.gl.UNIFORM_BUFFER,0,this.buffer),this.gl.bufferData(this.gl.UNIFORM_BUFFER,4*this.size,this.usage),this.gl.bindBufferBase(this.gl.UNIFORM_BUFFER,0,null)}d.prototype.set=function(a,b){var c=this.dataViews[this.types[a]];return 1===this.sizes[a]?c[this.offsets[a]]=b:c.set(b,this.offsets[a]),this},d.prototype.update=function(a){var b,c;if(void 0===a)b=this.data,c=0;else{var d=this.offsets[a],e=d+this.sizes[a];b=this.data.subarray(d,e),c=4*d}return this.gl.bindBufferBase(this.gl.UNIFORM_BUFFER,0,this.buffer),this.gl.bufferSubData(this.gl.UNIFORM_BUFFER,c,b),this.gl.bindBufferBase(this.gl.UNIFORM_BUFFER,0,null),this},d.prototype.delete=function(){this.buffer&&(this.gl.deleteBuffer(this.buffer),this.buffer=null)},d.prototype.bind=function(a){return this.gl.bindBufferBase(this.gl.UNIFORM_BUFFER,a,this.buffer),this},b.exports=d},{}],12:[function(a,b,c){"use strict";function d(a,b,c){this.gl=a,this.handle=b,this.glFuncName=PicoGL.UNIFORM_FUNC_NAME[c],this.cache=c!==PicoGL.BOOL&&0}function e(a,b,c,d){this.gl=a,this.handle=b,this.glFuncName=PicoGL.UNIFORM_FUNC_NAME[c]+"v",this.count=d,this.cache=new PicoGL.UNIFORM_CACHE_CLASS[c](PicoGL.UNIFORM_COMPONENT_COUNT[c]*d)}function f(a,b,c,d){this.gl=a,this.handle=b,this.glFuncName=PicoGL.UNIFORM_FUNC_NAME[c]+"v",this.count=d,this.cache=new Array(PicoGL.UNIFORM_COMPONENT_COUNT[c]*d).fill(!1)}function g(a,b,c,d){this.gl=a,this.handle=b,this.glFuncName=PicoGL.UNIFORM_FUNC_NAME[c],this.count=d,this.cache=new Float32Array(PicoGL.UNIFORM_COMPONENT_COUNT[c]*d)}d.prototype.set=function(a){this.cache!==a&&(this.gl[this.glFuncName](this.handle,a),this.cache=a)},e.prototype.set=function(a){for(var b=0,c=a.length;b<c;++b)if(this.cache[b]!==a[b])return this.gl[this.glFuncName](this.handle,a),void this.cache.set(a)},f.prototype.set=function(a){for(var b=0,c=a.length;b<c;++b)if(this.cache[b]!==a[b]){this.gl[this.glFuncName](this.handle,a);for(var d=b;d<c;d++)this.cache[d]=a[d];return}},g.prototype.set=function(a){for(var b=0,c=a.length;b<c;++b)if(this.cache[b]!==a[b])return this.gl[this.glFuncName](this.handle,!1,a),void this.cache.set(a)},b.exports.MatrixUniform=g,b.exports.MultiBoolUniform=f,b.exports.MultiNumericUniform=e,b.exports.SingleComponentUniform=d},{}],13:[function(a,b,c){"use strict";function d(a){this.gl=a,this.vertexArray=a.createVertexArray(),this.numElements=0,this.indexType=null,this.instancedBuffers=0,this.indexed=!1,this.numInstances=0}d.prototype.vertexAttributeBuffer=function(a,b){return this.attributeBuffer(a,b,!1),this},d.prototype.instanceAttributeBuffer=function(a,b){return this.attributeBuffer(a,b,!0),this},d.prototype.indexBuffer=function(a){return this.gl.bindVertexArray(this.vertexArray),this.gl.bindBuffer(a.binding,a.buffer),this.numElements=3*a.numItems,this.indexType=a.type,this.indexed=!0,this.gl.bindVertexArray(null),this.gl.bindBuffer(a.binding,null),this},d.prototype.delete=function(){return this.vertexArray&&(this.gl.deleteVertexArray(this.vertexArray),this.vertexArray=null),this.gl.bindVertexArray(null),this},d.prototype.bind=function(){return this.gl.bindVertexArray(this.vertexArray),this},d.prototype.attributeBuffer=function(a,b,c){this.gl.bindVertexArray(this.vertexArray),this.gl.bindBuffer(b.binding,b.buffer);for(var d=b.numColumns,e=0;e<d;++e)b.type===this.gl.FLOAT?this.gl.vertexAttribPointer(a+e,b.itemSize,b.type,!1,d*b.itemSize*PicoGL.TYPE_SIZE[b.type],e*b.itemSize*PicoGL.TYPE_SIZE[b.type]):this.gl.vertexAttribIPointer(a+e,b.itemSize,b.type,d*b.itemSize*PicoGL.TYPE_SIZE[b.type],e*b.itemSize*PicoGL.TYPE_SIZE[b.type]),c&&this.gl.vertexAttribDivisor(a+e,1),this.gl.enableVertexAttribArray(a+e);return this.instanced=this.instanced||c,c?this.numInstances=b.numItems:this.numElements=this.numElements||b.numItems,this.gl.bindVertexArray(null),this.gl.bindBuffer(b.binding,null),this},b.exports=d},{}],14:[function(a,b,c){"use strict";function d(a,b,c,d,e,f){var g;switch(b){case PicoGL.FLOAT_MAT4:case PicoGL.FLOAT_MAT4x2:case PicoGL.FLOAT_MAT4x3:g=4;break;case PicoGL.FLOAT_MAT3:case PicoGL.FLOAT_MAT3x2:case PicoGL.FLOAT_MAT3x4:g=3;break;case PicoGL.FLOAT_MAT2:case PicoGL.FLOAT_MAT2x3:case PicoGL.FLOAT_MAT2x4:g=2;break;default:g=1}switch(b){case PicoGL.FLOAT_MAT4:case PicoGL.FLOAT_MAT3x4:case PicoGL.FLOAT_MAT2x4:c=4,b=PicoGL.FLOAT;break;case PicoGL.FLOAT_MAT3:case PicoGL.FLOAT_MAT4x3:case PicoGL.FLOAT_MAT2x3:c=3,b=PicoGL.FLOAT;break;case PicoGL.FLOAT_MAT2:case PicoGL.FLOAT_MAT3x2:case PicoGL.FLOAT_MAT4x2:c=2,b=PicoGL.FLOAT}var h;"number"==typeof d?(h=d,d*=PicoGL.TYPE_SIZE[b]):h=d.length,this.gl=a,this.buffer=a.createBuffer(),this.type=b,this.itemSize=c,this.numItems=h/(c*g),this.numColumns=g,this.usage=e||a.STATIC_DRAW,this.indexArray=!!f,this.binding=this.indexArray?a.ELEMENT_ARRAY_BUFFER:a.ARRAY_BUFFER,a.bindBuffer(this.binding,this.buffer),a.bufferData(this.binding,d,this.usage),a.bindBuffer(this.binding,null)}d.prototype.data=function(a){return this.gl.bindBuffer(this.binding,this.buffer),this.gl.bufferSubData(this.binding,0,a),this.gl.bindBuffer(this.binding,null),this},d.prototype.delete=function(){this.buffer&&(this.gl.deleteBuffer(this.buffer),this.buffer=null)},b.exports=d},{}]},{},[5]);